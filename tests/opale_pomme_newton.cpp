#define ARMA_USE_SUPERLU 1

// [[Rcpp::depends("RcppArmadillo")]]
# include <RcppArmadillo.h>

using namespace arma;
using namespace Rcpp;
using namespace std;

// [[Rcpp::export]]
arma::vec prologue_equations_f(arma::mat& M, int& t){
arma::vec f_x_n(202);
f_x_n(1-1)=(M(t,787)-((M(t-(M(t,812)),788)+M(t-(M(t,812)+1),788)+M(t-(M(t,812)+2),788)+M(t-(M(t,812)+3),788))/(M(t-(M(t,812)),791)+M(t-(M(t,812)+1),791)+M(t-(M(t,812)+2),791)+M(t-(M(t,812)+3),791))));
f_x_n(2-1)=(M(t,792)-((M(t-(M(t,812)),793)+M(t-(M(t,812)+1),793)+M(t-(M(t,812)+2),793)+M(t-(M(t,812)+3),793))/(M(t-(M(t,812)),796)+M(t-(M(t,812)+1),796)+M(t-(M(t,812)+2),796)+M(t-(M(t,812)+3),796))));
f_x_n(3-1)=(M(t,797)-((M(t-(M(t,812)),798)+M(t-(M(t,812)+1),798)+M(t-(M(t,812)+2),798)+M(t-(M(t,812)+3),798))/(M(t-(M(t,812)),801)+M(t-(M(t,812)+1),801)+M(t-(M(t,812)+2),801)+M(t-(M(t,812)+3),801))));
f_x_n(4-1)=(M(t,529)-((M(t-(M(t,812)),530)+M(t-(M(t,812)+1),530)+M(t-(M(t,812)+2),530)+M(t-(M(t,812)+3),530))/(M(t-(M(t,812)),533)+M(t-(M(t,812)+1),533)+M(t-(M(t,812)+2),533)+M(t-(M(t,812)+3),533))));
f_x_n(5-1)=(M(t,534)-((M(t-(M(t,812)),535)+M(t-(M(t,812)+1),535)+M(t-(M(t,812)+2),535)+M(t-(M(t,812)+3),535))/(M(t-(M(t,812)),538)+M(t-(M(t,812)+1),538)+M(t-(M(t,812)+2),538)+M(t-(M(t,812)+3),538))));
f_x_n(6-1)=(M(t,524)-((M(t-(M(t,812)),525)+M(t-(M(t,812)+1),525)+M(t-(M(t,812)+2),525)+M(t-(M(t,812)+3),525))/(M(t-(M(t,812)),528)+M(t-(M(t,812)+1),528)+M(t-(M(t,812)+2),528)+M(t-(M(t,812)+3),528))));
f_x_n(7-1)=(M(t,519)-((M(t-(M(t,812)),520)+M(t-(M(t,812)+1),520)+M(t-(M(t,812)+2),520)+M(t-(M(t,812)+3),520))/(M(t-(M(t,812)),523)+M(t-(M(t,812)+1),523)+M(t-(M(t,812)+2),523)+M(t-(M(t,812)+3),523))));
f_x_n(8-1)=(M(t,503)-((M(t-(M(t,812)),504)+M(t-(M(t,812)+1),504)+M(t-(M(t,812)+2),504)+M(t-(M(t,812)+3),504))/(M(t-(M(t,812)),507)+M(t-(M(t,812)+1),507)+M(t-(M(t,812)+2),507)+M(t-(M(t,812)+3),507))));
f_x_n(9-1)=(M(t,514)-((M(t-(M(t,812)),515)+M(t-(M(t,812)+1),515)+M(t-(M(t,812)+2),515)+M(t-(M(t,812)+3),515))/(M(t-(M(t,812)),518)+M(t-(M(t,812)+1),518)+M(t-(M(t,812)+2),518)+M(t-(M(t,812)+3),518))));
f_x_n(10-1)=(M(t,560)-((M(t-(M(t,812)),561)+M(t-(M(t,812)+1),561)+M(t-(M(t,812)+2),561)+M(t-(M(t,812)+3),561))/(M(t-(M(t,812)),564)+M(t-(M(t,812)+1),564)+M(t-(M(t,812)+2),564)+M(t-(M(t,812)+3),564))));
f_x_n(11-1)=(M(t,545)-((M(t-(M(t,812)),546)+M(t-(M(t,812)+1),546)+M(t-(M(t,812)+2),546)+M(t-(M(t,812)+3),546))/(M(t-(M(t,812)),549)+M(t-(M(t,812)+1),549)+M(t-(M(t,812)+2),549)+M(t-(M(t,812)+3),549))));
f_x_n(12-1)=(M(t,550)-((M(t-(M(t,812)),551)+M(t-(M(t,812)+1),551)+M(t-(M(t,812)+2),551)+M(t-(M(t,812)+3),551))/(M(t-(M(t,812)),554)+M(t-(M(t,812)+1),554)+M(t-(M(t,812)+2),554)+M(t-(M(t,812)+3),554))));
f_x_n(13-1)=(M(t,565)-((M(t-(M(t,812)),566)+M(t-(M(t,812)+1),566)+M(t-(M(t,812)+2),566)+M(t-(M(t,812)+3),566))/(M(t-(M(t,812)),569)+M(t-(M(t,812)+1),569)+M(t-(M(t,812)+2),569)+M(t-(M(t,812)+3),569))));
f_x_n(14-1)=(M(t,555)-((M(t-(M(t,812)),556)+M(t-(M(t,812)+1),556)+M(t-(M(t,812)+2),556)+M(t-(M(t,812)+3),556))/(M(t-(M(t,812)),559)+M(t-(M(t,812)+1),559)+M(t-(M(t,812)+2),559)+M(t-(M(t,812)+3),559))));
f_x_n(15-1)=(M(t,540)-((M(t-(M(t,812)),541)+M(t-(M(t,812)+1),541)+M(t-(M(t,812)+2),541)+M(t-(M(t,812)+3),541))/(M(t-(M(t,812)),544)+M(t-(M(t,812)+1),544)+M(t-(M(t,812)+2),544)+M(t-(M(t,812)+3),544))));
f_x_n(16-1)=(M(t,580)-((M(t-(M(t,812)),581)+M(t-(M(t,812)+1),581)+M(t-(M(t,812)+2),581)+M(t-(M(t,812)+3),581))/(M(t-(M(t,812)),584)+M(t-(M(t,812)+1),584)+M(t-(M(t,812)+2),584)+M(t-(M(t,812)+3),584))));
f_x_n(17-1)=(M(t,570)-((M(t-(M(t,812)),571)+M(t-(M(t,812)+1),571)+M(t-(M(t,812)+2),571)+M(t-(M(t,812)+3),571))/(M(t-(M(t,812)),574)+M(t-(M(t,812)+1),574)+M(t-(M(t,812)+2),574)+M(t-(M(t,812)+3),574))));
f_x_n(18-1)=(M(t,575)-((M(t-(M(t,812)),576)+M(t-(M(t,812)+1),576)+M(t-(M(t,812)+2),576)+M(t-(M(t,812)+3),576))/(M(t-(M(t,812)),579)+M(t-(M(t,812)+1),579)+M(t-(M(t,812)+2),579)+M(t-(M(t,812)+3),579))));
f_x_n(19-1)=(M(t,595)-((M(t-(M(t,812)),596)+M(t-(M(t,812)+1),596)+M(t-(M(t,812)+2),596)+M(t-(M(t,812)+3),596))/(M(t-(M(t,812)),599)+M(t-(M(t,812)+1),599)+M(t-(M(t,812)+2),599)+M(t-(M(t,812)+3),599))));
f_x_n(20-1)=(M(t,585)-((M(t-(M(t,812)),586)+M(t-(M(t,812)+1),586)+M(t-(M(t,812)+2),586)+M(t-(M(t,812)+3),586))/(M(t-(M(t,812)),589)+M(t-(M(t,812)+1),589)+M(t-(M(t,812)+2),589)+M(t-(M(t,812)+3),589))));
f_x_n(21-1)=(M(t,590)-((M(t-(M(t,812)),591)+M(t-(M(t,812)+1),591)+M(t-(M(t,812)+2),591)+M(t-(M(t,812)+3),591))/(M(t-(M(t,812)),594)+M(t-(M(t,812)+1),594)+M(t-(M(t,812)+2),594)+M(t-(M(t,812)+3),594))));
f_x_n(22-1)=(M(t,600)-((M(t-(M(t,812)),601)+M(t-(M(t,812)+1),601)+M(t-(M(t,812)+2),601)+M(t-(M(t,812)+3),601))/(M(t-(M(t,812)),604)+M(t-(M(t,812)+1),604)+M(t-(M(t,812)+2),604)+M(t-(M(t,812)+3),604))));
f_x_n(23-1)=(M(t,488)-((M(t-(M(t,812)),489)+M(t-(M(t,812)+1),489)+M(t-(M(t,812)+2),489)+M(t-(M(t,812)+3),489))/(M(t-(M(t,812)),492)+M(t-(M(t,812)+1),492)+M(t-(M(t,812)+2),492)+M(t-(M(t,812)+3),492))));
f_x_n(24-1)=(M(t,478)-((M(t-(M(t,812)),479)+M(t-(M(t,812)+1),479)+M(t-(M(t,812)+2),479)+M(t-(M(t,812)+3),479))/(M(t-(M(t,812)),482)+M(t-(M(t,812)+1),482)+M(t-(M(t,812)+2),482)+M(t-(M(t,812)+3),482))));
f_x_n(25-1)=(M(t,483)-((M(t-(M(t,812)),484)+M(t-(M(t,812)+1),484)+M(t-(M(t,812)+2),484)+M(t-(M(t,812)+3),484))/(M(t-(M(t,812)),487)+M(t-(M(t,812)+1),487)+M(t-(M(t,812)+2),487)+M(t-(M(t,812)+3),487))));
f_x_n(26-1)=(M(t,493)-((M(t-(M(t,812)),494)+M(t-(M(t,812)+1),494)+M(t-(M(t,812)+2),494)+M(t-(M(t,812)+3),494))/(M(t-(M(t,812)),497)+M(t-(M(t,812)+1),497)+M(t-(M(t,812)+2),497)+M(t-(M(t,812)+3),497))));
f_x_n(27-1)=(M(t,509)-((M(t-(M(t,812)),510)+M(t-(M(t,812)+1),510)+M(t-(M(t,812)+2),510)+M(t-(M(t,812)+3),510))/(M(t-(M(t,812)),513)+M(t-(M(t,812)+1),513)+M(t-(M(t,812)+2),513)+M(t-(M(t,812)+3),513))));
f_x_n(28-1)=(M(t,605)-((M(t-(M(t,812)),606)+M(t-(M(t,812)+1),606)+M(t-(M(t,812)+2),606)+M(t-(M(t,812)+3),606))/(M(t-(M(t,812)),609)+M(t-(M(t,812)+1),609)+M(t-(M(t,812)+2),609)+M(t-(M(t,812)+3),609))));
f_x_n(29-1)=(M(t,610)-((M(t-(M(t,812)),611)+M(t-(M(t,812)+1),611)+M(t-(M(t,812)+2),611)+M(t-(M(t,812)+3),611))/(M(t-(M(t,812)),614)+M(t-(M(t,812)+1),614)+M(t-(M(t,812)+2),614)+M(t-(M(t,812)+3),614))));
f_x_n(30-1)=(M(t,615)-((M(t-(M(t,812)),616)+M(t-(M(t,812)+1),616)+M(t-(M(t,812)+2),616)+M(t-(M(t,812)+3),616))/(M(t-(M(t,812)),619)+M(t-(M(t,812)+1),619)+M(t-(M(t,812)+2),619)+M(t-(M(t,812)+3),619))));
f_x_n(31-1)=(M(t,620)-((M(t-(M(t,812)),621)+M(t-(M(t,812)+1),621)+M(t-(M(t,812)+2),621)+M(t-(M(t,812)+3),621))/(M(t-(M(t,812)),624)+M(t-(M(t,812)+1),624)+M(t-(M(t,812)+2),624)+M(t-(M(t,812)+3),624))));
f_x_n(32-1)=(M(t,625)-((M(t-(M(t,812)),626)+M(t-(M(t,812)+1),626)+M(t-(M(t,812)+2),626)+M(t-(M(t,812)+3),626))/(M(t-(M(t,812)),629)+M(t-(M(t,812)+1),629)+M(t-(M(t,812)+2),629)+M(t-(M(t,812)+3),629))));
f_x_n(33-1)=(M(t,650)-((M(t-(M(t,812)),651)+M(t-(M(t,812)+1),651)+M(t-(M(t,812)+2),651)+M(t-(M(t,812)+3),651))/(M(t-(M(t,812)),654)+M(t-(M(t,812)+1),654)+M(t-(M(t,812)+2),654)+M(t-(M(t,812)+3),654))));
f_x_n(34-1)=(M(t,655)-((M(t-(M(t,812)),656)+M(t-(M(t,812)+1),656)+M(t-(M(t,812)+2),656)+M(t-(M(t,812)+3),656))/(M(t-(M(t,812)),659)+M(t-(M(t,812)+1),659)+M(t-(M(t,812)+2),659)+M(t-(M(t,812)+3),659))));
f_x_n(35-1)=(M(t,660)-((M(t-(M(t,812)),661)+M(t-(M(t,812)+1),661)+M(t-(M(t,812)+2),661)+M(t-(M(t,812)+3),661))/(M(t-(M(t,812)),664)+M(t-(M(t,812)+1),664)+M(t-(M(t,812)+2),664)+M(t-(M(t,812)+3),664))));
f_x_n(36-1)=(M(t,630)-((M(t-(M(t,812)),631)+M(t-(M(t,812)+1),631)+M(t-(M(t,812)+2),631)+M(t-(M(t,812)+3),631))/(M(t-(M(t,812)),634)+M(t-(M(t,812)+1),634)+M(t-(M(t,812)+2),634)+M(t-(M(t,812)+3),634))));
f_x_n(37-1)=(M(t,635)-((M(t-(M(t,812)),636)+M(t-(M(t,812)+1),636)+M(t-(M(t,812)+2),636)+M(t-(M(t,812)+3),636))/(M(t-(M(t,812)),639)+M(t-(M(t,812)+1),639)+M(t-(M(t,812)+2),639)+M(t-(M(t,812)+3),639))));
f_x_n(38-1)=(M(t,640)-((M(t-(M(t,812)),641)+M(t-(M(t,812)+1),641)+M(t-(M(t,812)+2),641)+M(t-(M(t,812)+3),641))/(M(t-(M(t,812)),644)+M(t-(M(t,812)+1),644)+M(t-(M(t,812)+2),644)+M(t-(M(t,812)+3),644))));
f_x_n(39-1)=(M(t,645)-((M(t-(M(t,812)),646)+M(t-(M(t,812)+1),646)+M(t-(M(t,812)+2),646)+M(t-(M(t,812)+3),646))/(M(t-(M(t,812)),649)+M(t-(M(t,812)+1),649)+M(t-(M(t,812)+2),649)+M(t-(M(t,812)+3),649))));
f_x_n(40-1)=(M(t,677)-((M(t-(M(t,812)),678)+M(t-(M(t,812)+1),678)+M(t-(M(t,812)+2),678)+M(t-(M(t,812)+3),678))/(M(t-(M(t,812)),681)+M(t-(M(t,812)+1),681)+M(t-(M(t,812)+2),681)+M(t-(M(t,812)+3),681))));
f_x_n(41-1)=(M(t,682)-((M(t-(M(t,812)),683)+M(t-(M(t,812)+1),683)+M(t-(M(t,812)+2),683)+M(t-(M(t,812)+3),683))/(M(t-(M(t,812)),686)+M(t-(M(t,812)+1),686)+M(t-(M(t,812)+2),686)+M(t-(M(t,812)+3),686))));
f_x_n(42-1)=(M(t,667)-((M(t-(M(t,812)),668)+M(t-(M(t,812)+1),668)+M(t-(M(t,812)+2),668)+M(t-(M(t,812)+3),668))/(M(t-(M(t,812)),671)+M(t-(M(t,812)+1),671)+M(t-(M(t,812)+2),671)+M(t-(M(t,812)+3),671))));
f_x_n(43-1)=(M(t,707)-((M(t-(M(t,812)),708)+M(t-(M(t,812)+1),708)+M(t-(M(t,812)+2),708)+M(t-(M(t,812)+3),708))/(M(t-(M(t,812)),711)+M(t-(M(t,812)+1),711)+M(t-(M(t,812)+2),711)+M(t-(M(t,812)+3),711))));
f_x_n(44-1)=(M(t,712)-((M(t-(M(t,812)),713)+M(t-(M(t,812)+1),713)+M(t-(M(t,812)+2),713)+M(t-(M(t,812)+3),713))/(M(t-(M(t,812)),716)+M(t-(M(t,812)+1),716)+M(t-(M(t,812)+2),716)+M(t-(M(t,812)+3),716))));
f_x_n(45-1)=(M(t,672)-((M(t-(M(t,812)),673)+M(t-(M(t,812)+1),673)+M(t-(M(t,812)+2),673)+M(t-(M(t,812)+3),673))/(M(t-(M(t,812)),676)+M(t-(M(t,812)+1),676)+M(t-(M(t,812)+2),676)+M(t-(M(t,812)+3),676))));
f_x_n(46-1)=(M(t,687)-((M(t-(M(t,812)),688)+M(t-(M(t,812)+1),688)+M(t-(M(t,812)+2),688)+M(t-(M(t,812)+3),688))/(M(t-(M(t,812)),691)+M(t-(M(t,812)+1),691)+M(t-(M(t,812)+2),691)+M(t-(M(t,812)+3),691))));
f_x_n(47-1)=(M(t,722)-((M(t-(M(t,812)),723)+M(t-(M(t,812)+1),723)+M(t-(M(t,812)+2),723)+M(t-(M(t,812)+3),723))/(M(t-(M(t,812)),726)+M(t-(M(t,812)+1),726)+M(t-(M(t,812)+2),726)+M(t-(M(t,812)+3),726))));
f_x_n(48-1)=(M(t,717)-((M(t-(M(t,812)),718)+M(t-(M(t,812)+1),718)+M(t-(M(t,812)+2),718)+M(t-(M(t,812)+3),718))/(M(t-(M(t,812)),721)+M(t-(M(t,812)+1),721)+M(t-(M(t,812)+2),721)+M(t-(M(t,812)+3),721))));
f_x_n(49-1)=(M(t,697)-((M(t-(M(t,812)),698)+M(t-(M(t,812)+1),698)+M(t-(M(t,812)+2),698)+M(t-(M(t,812)+3),698))/(M(t-(M(t,812)),701)+M(t-(M(t,812)+1),701)+M(t-(M(t,812)+2),701)+M(t-(M(t,812)+3),701))));
f_x_n(50-1)=(M(t,702)-((M(t-(M(t,812)),703)+M(t-(M(t,812)+1),703)+M(t-(M(t,812)+2),703)+M(t-(M(t,812)+3),703))/(M(t-(M(t,812)),706)+M(t-(M(t,812)+1),706)+M(t-(M(t,812)+2),706)+M(t-(M(t,812)+3),706))));
f_x_n(51-1)=(M(t,692)-((M(t-(M(t,812)),693)+M(t-(M(t,812)+1),693)+M(t-(M(t,812)+2),693)+M(t-(M(t,812)+3),693))/(M(t-(M(t,812)),696)+M(t-(M(t,812)+1),696)+M(t-(M(t,812)+2),696)+M(t-(M(t,812)+3),696))));
f_x_n(52-1)=(M(t,737)-((M(t-(M(t,812)),738)+M(t-(M(t,812)+1),738)+M(t-(M(t,812)+2),738)+M(t-(M(t,812)+3),738))/(M(t-(M(t,812)),741)+M(t-(M(t,812)+1),741)+M(t-(M(t,812)+2),741)+M(t-(M(t,812)+3),741))));
f_x_n(53-1)=(M(t,742)-((M(t-(M(t,812)),743)+M(t-(M(t,812)+1),743)+M(t-(M(t,812)+2),743)+M(t-(M(t,812)+3),743))/(M(t-(M(t,812)),746)+M(t-(M(t,812)+1),746)+M(t-(M(t,812)+2),746)+M(t-(M(t,812)+3),746))));
f_x_n(54-1)=(M(t,767)-((M(t-(M(t,812)),768)+M(t-(M(t,812)+1),768)+M(t-(M(t,812)+2),768)+M(t-(M(t,812)+3),768))/(M(t-(M(t,812)),771)+M(t-(M(t,812)+1),771)+M(t-(M(t,812)+2),771)+M(t-(M(t,812)+3),771))));
f_x_n(55-1)=(M(t,772)-((M(t-(M(t,812)),773)+M(t-(M(t,812)+1),773)+M(t-(M(t,812)+2),773)+M(t-(M(t,812)+3),773))/(M(t-(M(t,812)),776)+M(t-(M(t,812)+1),776)+M(t-(M(t,812)+2),776)+M(t-(M(t,812)+3),776))));
f_x_n(56-1)=(M(t,732)-((M(t-(M(t,812)),733)+M(t-(M(t,812)+1),733)+M(t-(M(t,812)+2),733)+M(t-(M(t,812)+3),733))/(M(t-(M(t,812)),736)+M(t-(M(t,812)+1),736)+M(t-(M(t,812)+2),736)+M(t-(M(t,812)+3),736))));
f_x_n(57-1)=(M(t,782)-((M(t-(M(t,812)),783)+M(t-(M(t,812)+1),783)+M(t-(M(t,812)+2),783)+M(t-(M(t,812)+3),783))/(M(t-(M(t,812)),786)+M(t-(M(t,812)+1),786)+M(t-(M(t,812)+2),786)+M(t-(M(t,812)+3),786))));
f_x_n(58-1)=(M(t,747)-((M(t-(M(t,812)),748)+M(t-(M(t,812)+1),748)+M(t-(M(t,812)+2),748)+M(t-(M(t,812)+3),748))/(M(t-(M(t,812)),751)+M(t-(M(t,812)+1),751)+M(t-(M(t,812)+2),751)+M(t-(M(t,812)+3),751))));
f_x_n(59-1)=(M(t,777)-((M(t-(M(t,812)),778)+M(t-(M(t,812)+1),778)+M(t-(M(t,812)+2),778)+M(t-(M(t,812)+3),778))/(M(t-(M(t,812)),781)+M(t-(M(t,812)+1),781)+M(t-(M(t,812)+2),781)+M(t-(M(t,812)+3),781))));
f_x_n(60-1)=(M(t,727)-((M(t-(M(t,812)),728)+M(t-(M(t,812)+1),728)+M(t-(M(t,812)+2),728)+M(t-(M(t,812)+3),728))/(M(t-(M(t,812)),731)+M(t-(M(t,812)+1),731)+M(t-(M(t,812)+2),731)+M(t-(M(t,812)+3),731))));
f_x_n(61-1)=(M(t,757)-((M(t-(M(t,812)),758)+M(t-(M(t,812)+1),758)+M(t-(M(t,812)+2),758)+M(t-(M(t,812)+3),758))/(M(t-(M(t,812)),761)+M(t-(M(t,812)+1),761)+M(t-(M(t,812)+2),761)+M(t-(M(t,812)+3),761))));
f_x_n(62-1)=(M(t,762)-((M(t-(M(t,812)),763)+M(t-(M(t,812)+1),763)+M(t-(M(t,812)+2),763)+M(t-(M(t,812)+3),763))/(M(t-(M(t,812)),766)+M(t-(M(t,812)+1),766)+M(t-(M(t,812)+2),766)+M(t-(M(t,812)+3),766))));
f_x_n(63-1)=(M(t,752)-((M(t-(M(t,812)),753)+M(t-(M(t,812)+1),753)+M(t-(M(t,812)+2),753)+M(t-(M(t,812)+3),753))/(M(t-(M(t,812)),756)+M(t-(M(t,812)+1),756)+M(t-(M(t,812)+2),756)+M(t-(M(t,812)+3),756))));
f_x_n(64-1)=(M(t,517)-(M(t,518)*M(t,514)));
f_x_n(65-1)=(M(t,568)-(M(t,569)*M(t,565)));
f_x_n(66-1)=(M(t,603)-(M(t,604)*M(t,600)));
f_x_n(67-1)=(M(t,496)-(M(t,497)*M(t,493)));
f_x_n(68-1)=(M(t,608)-(M(t,609)*M(t,605)));
f_x_n(69-1)=(M(t,618)-(M(t,619)*M(t,615)));
f_x_n(70-1)=(M(t,663)-(M(t,664)*M(t,660)));
f_x_n(71-1)=(M(t,638)-(M(t,639)*M(t,635)));
f_x_n(72-1)=(M(t,643)-(M(t,644)*M(t,640)));
f_x_n(73-1)=(M(t,648)-(M(t,649)*M(t,645)));
f_x_n(74-1)=(M(t,670)-(M(t,671)*M(t,667)));
f_x_n(75-1)=(M(t,685)-(M(t,686)*M(t,682)));
f_x_n(76-1)=(M(t,710)-(M(t,711)*M(t,707)));
f_x_n(77-1)=(M(t,715)-(M(t,716)*M(t,712)));
f_x_n(78-1)=(M(t,675)-(M(t,676)*M(t,672)));
f_x_n(79-1)=(M(t,690)-(M(t,691)*M(t,687)));
f_x_n(80-1)=(M(t,725)-(M(t,726)*M(t,722)));
f_x_n(81-1)=(M(t,695)-(M(t,696)*M(t,692)));
f_x_n(82-1)=(M(t,730)-(M(t,731)*M(t,727)));
f_x_n(83-1)=(M(t,750)-(M(t,751)*M(t,747)));
f_x_n(84-1)=(M(t,785)-(M(t,786)*M(t,782)));
f_x_n(85-1)=(M(t,515)-(M(t,518)*M(t,516)/100));
f_x_n(86-1)=(M(t,566)-(M(t,569)*M(t,567)/100));
f_x_n(87-1)=(M(t,601)-(M(t,604)*M(t,602)/100));
f_x_n(88-1)=(M(t,494)-(M(t,497)*M(t,495)/100));
f_x_n(89-1)=(M(t,606)-(M(t,609)*M(t,607)/100));
f_x_n(90-1)=(M(t,616)-(M(t,619)*M(t,617)/100));
f_x_n(91-1)=(M(t,636)-(M(t,639)*M(t,637)/100));
f_x_n(92-1)=(M(t,641)-(M(t,644)*M(t,642)/100));
f_x_n(93-1)=(M(t,646)-(M(t,649)*M(t,647)/100));
f_x_n(94-1)=(M(t,683)-(M(t,686)*M(t,684)/100));
f_x_n(95-1)=(M(t,708)-(M(t,711)*M(t,709)/100));
f_x_n(96-1)=(M(t,713)-(M(t,716)*M(t,714)/100));
f_x_n(97-1)=(M(t,673)-(M(t,676)*M(t,674)/100));
f_x_n(98-1)=(M(t,688)-(M(t,691)*M(t,689)/100));
f_x_n(99-1)=(M(t,668)-(M(t,671)*M(t,669)/100));
f_x_n(100-1)=(M(t,693)-(M(t,696)*M(t,694)/100));
f_x_n(101-1)=(M(t,728)-(M(t,731)*M(t,729)/100));
f_x_n(102-1)=(M(t,748)-(M(t,751)*M(t,749)/100));
f_x_n(103-1)=(M(t,88)-(100*(M(t,606)-M(t-1,606))/M(t-1,788)));
f_x_n(104-1)=(M(t,90)-(100*(M(t,616)-M(t-1,616))/M(t-1,788)));
f_x_n(105-1)=(M(t,93)-(100*(M(t,636)-M(t-1,636))/M(t-1,788)));
f_x_n(106-1)=(M(t,94)-(100*(M(t,641)-M(t-1,641))/M(t-1,788)));
f_x_n(107-1)=(M(t,95)-(100*(M(t,646)-M(t-1,646))/M(t-1,788)));
f_x_n(108-1)=(M(t,100)-(100*(M(t,668)-M(t-1,668))/M(t-1,788)));
f_x_n(109-1)=(M(t,103)-(100*(M(t,708)-M(t-1,708))/M(t-1,788)));
f_x_n(110-1)=(M(t,102)-(100*(M(t,688)-M(t-1,688))/M(t-1,788)));
f_x_n(111-1)=(M(t,106)-(-100*(M(t,728)-M(t-1,728))/M(t-1,788)));
f_x_n(112-1)=(M(t,108)-(-100*(M(t,748)-M(t-1,748))/M(t-1,788)));
f_x_n(113-1)=(M(t,79)-(100*(M(t,494)-M(t-1,494))/M(t-1,788)));
f_x_n(114-1)=(M(t,82)-(M(t,88)+M(t,93)));
f_x_n(115-1)=(M(t,162)-((M(t,813))*(100*(M(t,608)/M(t,787)-(M(t-1,608)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,605)/M(t,787)-(M(t-1,605)/M(t-1,787)))*(M(t-1,609)+M(t-2,609)+M(t-3,609)+M(t-4,609))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,608)/M(t,787)-(M(t-1,608)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(116-1)=(M(t,164)-((M(t,813))*(100*(M(t,618)/M(t,787)-(M(t-1,618)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,615)/M(t,787)-(M(t-1,615)/M(t-1,787)))*(M(t-1,619)+M(t-2,619)+M(t-3,619)+M(t-4,619))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,618)/M(t,787)-(M(t-1,618)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(117-1)=(M(t,172)-((M(t,813))*(100*(M(t,663)/M(t,787)-(M(t-1,663)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,660)/M(t,787)-(M(t-1,660)/M(t-1,787)))*(M(t-1,664)+M(t-2,664)+M(t-3,664)+M(t-4,664))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,663)/M(t,787)-(M(t-1,663)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(118-1)=(M(t,167)-((M(t,813))*(100*(M(t,638)/M(t,787)-(M(t-1,638)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,635)/M(t,787)-(M(t-1,635)/M(t-1,787)))*(M(t-1,639)+M(t-2,639)+M(t-3,639)+M(t-4,639))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,638)/M(t,787)-(M(t-1,638)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(119-1)=(M(t,168)-((M(t,813))*(100*(M(t,643)/M(t,787)-(M(t-1,643)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,640)/M(t,787)-(M(t-1,640)/M(t-1,787)))*(M(t-1,644)+M(t-2,644)+M(t-3,644)+M(t-4,644))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,643)/M(t,787)-(M(t-1,643)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(120-1)=(M(t,169)-((M(t,813))*(100*(M(t,648)/M(t,787)-(M(t-1,648)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,645)/M(t,787)-(M(t-1,645)/M(t-1,787)))*(M(t-1,649)+M(t-2,649)+M(t-3,649)+M(t-4,649))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,648)/M(t,787)-(M(t-1,648)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(121-1)=(M(t,174)-((M(t,813))*(100*(M(t,670)/M(t,787)-(M(t-1,670)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,667)/M(t,787)-(M(t-1,667)/M(t-1,787)))*(M(t-1,671)+M(t-2,671)+M(t-3,671)+M(t-4,671))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,670)/M(t,787)-(M(t-1,670)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(122-1)=(M(t,177)-((M(t,813))*(100*(M(t,710)/M(t,787)-(M(t-1,710)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,707)/M(t,787)-(M(t-1,707)/M(t-1,787)))*(M(t-1,711)+M(t-2,711)+M(t-3,711)+M(t-4,711))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,710)/M(t,787)-(M(t-1,710)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(123-1)=(M(t,176)-((M(t,813))*(100*(M(t,690)/M(t,787)-(M(t-1,690)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,687)/M(t,787)-(M(t-1,687)/M(t-1,787)))*(M(t-1,691)+M(t-2,691)+M(t-3,691)+M(t-4,691))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,690)/M(t,787)-(M(t-1,690)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(124-1)=(M(t,179)-((M(t,813))*(100*(M(t,725)/M(t,787)-(M(t-1,725)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,722)/M(t,787)-(M(t-1,722)/M(t-1,787)))*(M(t-1,726)+M(t-2,726)+M(t-3,726)+M(t-4,726))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,725)/M(t,787)-(M(t-1,725)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(125-1)=(-M(t,180)-((M(t,813))*(100*(M(t,730)/M(t,787)-(M(t-1,730)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,727)/M(t,787)-(M(t-1,727)/M(t-1,787)))*(M(t-1,731)+M(t-2,731)+M(t-3,731)+M(t-4,731))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,730)/M(t,787)-(M(t-1,730)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(126-1)=(-M(t,182)-((M(t,813))*(100*(M(t,750)/M(t,787)-(M(t-1,750)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,747)/M(t,787)-(M(t-1,747)/M(t-1,787)))*(M(t-1,751)+M(t-2,751)+M(t-3,751)+M(t-4,751))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,750)/M(t,787)-(M(t-1,750)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(127-1)=(-M(t,185)-((M(t,813))*(100*(M(t,785)/M(t,787)-(M(t-1,785)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,782)/M(t,787)-(M(t-1,782)/M(t-1,787)))*(M(t-1,786)+M(t-2,786)+M(t-3,786)+M(t-4,786))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,785)/M(t,787)-(M(t-1,785)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(128-1)=(M(t,153)-((M(t,813))*(100*(M(t,496)/M(t,787)-(M(t-1,496)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,493)/M(t,787)-(M(t-1,493)/M(t-1,787)))*(M(t-1,497)+M(t-2,497)+M(t-3,497)+M(t-4,497))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,496)/M(t,787)-(M(t-1,496)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(129-1)=(M(t,156)-(M(t,162)+M(t,167)));
f_x_n(130-1)=(M(t,125)-(M(t,88)-M(t,162)));
f_x_n(131-1)=(M(t,127)-(M(t,90)-M(t,164)));
f_x_n(132-1)=(M(t,130)-(M(t,93)-M(t,167)));
f_x_n(133-1)=(M(t,131)-(M(t,94)-M(t,168)));
f_x_n(134-1)=(M(t,132)-(M(t,95)-M(t,169)));
f_x_n(135-1)=(M(t,137)-(M(t,100)-M(t,174)));
f_x_n(136-1)=(M(t,140)-(M(t,103)-M(t,177)));
f_x_n(137-1)=(M(t,139)-(M(t,102)-M(t,176)));
f_x_n(138-1)=(M(t,143)-(M(t,106)-M(t,180)));
f_x_n(139-1)=(M(t,145)-(M(t,108)-M(t,182)));
f_x_n(140-1)=(M(t,116)-(M(t,79)-M(t,153)));
f_x_n(141-1)=(M(t,119)-(M(t,125)+M(t,130)));
f_x_n(142-1)=(M(t,517)-(M(t,608)+M(t,638)));
f_x_n(143-1)=(M(t,568)-(M(t,496)+M(t,603)));
f_x_n(144-1)=(M(t,685)-(M(t,670)+M(t,710)+M(t,690)));
f_x_n(145-1)=(M(t,710)-(M(t,675)+M(t,715)));
f_x_n(146-1)=(M(t,695)-(M(t,690)+M(t,675)));
f_x_n(147-1)=(M(t,515)-(M(t,606)+M(t,636)));
f_x_n(148-1)=(M(t,566)-(M(t,494)+M(t,601)));
f_x_n(149-1)=(M(t,683)-(M(t,668)+M(t,708)+M(t,688)));
f_x_n(150-1)=(M(t,708)-(M(t,673)+M(t,713)));
f_x_n(151-1)=(M(t,693)-(M(t,688)+M(t,673)));
f_x_n(152-1)=(M(t,471)-(M(t,475)+M(t,472)));
f_x_n(153-1)=(M(t,475)-(M(t,40)*M(t,473)));
f_x_n(154-1)=(M(t,456)-(M(t,461)+M(t,465)));
f_x_n(155-1)=(M(t,460)-(M(t,461)/M(t,241)));
f_x_n(156-1)=(M(t,452)-(-M(t,468)-M(t,469)+M(t,470)));
f_x_n(157-1)=(M(t,241)-(M(t,67)/(M(t,67)+M(t,66))*M(t,249)+M(t,66)/(M(t,67)+M(t,66))*M(t,243)));
f_x_n(158-1)=(M(t,18)-(M(t,19)*M(t,824)));
f_x_n(159-1)=(M(t,416)-(exp(0.142194*log(M(t,230)*M(t,231))+0.020606*log(M(t,4)*M(t,5))+0.047249*log(M(t,21)*M(t,22))+0.019981*log(M(t,209)*M(t,210))+0.03086*log(M(t,223)*M(t,224))+0.007282*log(M(t,227)*M(t,228))+0.002333*log(M(t,233)*M(t,234))+0.016907*log(M(t,256)*M(t,257))+0.050668*log(M(t,259)*M(t,260))+0.079384*log(M(t,301)*M(t,302))+0.008336*log(M(t,420)*M(t,421))+0.034439*log(M(t,304)*M(t,305))+0.034033*log(M(t,447)*M(t,448))+0.044378*log(M(t,444)*M(t,445))+0.089749*log(M(t,820)*M(t,821))+0.021012*log(M(t,816)*M(t,817))+0.135089*log(M(t,823)*M(t,824))+0.039399*log(M(t,24)*M(t,25))+0.031923*log(M(t,267)*M(t,268))+0.044464*log(M(t,188)*M(t,189))+0.018095*log(M(t,1)*M(t,2))+0.002998*log(M(t,307)*M(t,308))+0.078624*log(M(t,262)*M(t,263)))));
f_x_n(160-1)=(M(t,415)-(exp(0.206592*log(M(t,230)*M(t,231))+0.01127*log(M(t,4)*M(t,5))+0.118967*log(M(t,21)*M(t,22))+0.012121*log(M(t,209)*M(t,210))+0.073786*log(M(t,223)*M(t,224))+0.004507*log(M(t,227)*M(t,228))+0.001435*log(M(t,233)*M(t,234))+0.010538*log(M(t,256)*M(t,257))+0.092116*log(M(t,259)*M(t,260))+0.064635*log(M(t,301)*M(t,302))+0.01064*log(M(t,420)*M(t,421))+0.030833*log(M(t,304)*M(t,305))+0.025585*log(M(t,447)*M(t,448))+0.054114*log(M(t,444)*M(t,445))+0.101182*log(M(t,820)*M(t,821))+0.02159*log(M(t,816)*M(t,817))+0.103115*log(M(t,823)*M(t,824))+0.008472*log(M(t,24)*M(t,25))+0.003704*log(M(t,267)*M(t,268))+0.011471*log(M(t,188)*M(t,189))+0.003057*log(M(t,1)*M(t,2))+0.001254*log(M(t,307)*M(t,308))+0.029017*log(M(t,262)*M(t,263)))));
f_x_n(161-1)=(M(t,197)-(exp(0.142194*log(M(t,229)*M(t,231))+0.020606*log(M(t,3)*M(t,5))+0.047249*log(M(t,20)*M(t,22))+0.019981*log(M(t,208)*M(t,210))+0.03086*log(M(t,222)*M(t,224))+0.007282*log(M(t,226)*M(t,228))+0.002333*log(M(t,232)*M(t,234))+0.016907*log(M(t,255)*M(t,257))+0.050668*log(M(t,258)*M(t,260))+0.079384*log(M(t,300)*M(t,302))+0.008336*log(M(t,419)*M(t,421))+0.034439*log(M(t,303)*M(t,305))+0.034033*log(M(t,446)*M(t,448))+0.044378*log(M(t,443)*M(t,445))+0.089749*log(M(t,819)*M(t,821))+0.021012*log(M(t,815)*M(t,817))+0.135089*log(M(t,822)*M(t,824))+0.039399*log(M(t,23)*M(t,25))+0.031923*log(M(t,266)*M(t,268))+0.044464*log(M(t,187)*M(t,189))+0.018095*log(M(t,0)*M(t,2))+0.002998*log(M(t,306)*M(t,308))+0.078624*log(M(t,261)*M(t,263)))));
f_x_n(162-1)=(M(t,414)-(M(t,686)/M(t,211)));
f_x_n(163-1)=(M(t,6)-((M(t,668)-M(t,728))/1000));
f_x_n(164-1)=(M(t,10)-((M(t,688)-M(t,748))/1000));
f_x_n(165-1)=(M(t,604)-(M(t,46)*M(t,609)));
f_x_n(166-1)=(M(t,497)-(M(t,31)*M(t,460)));
f_x_n(167-1)=(M(t,619)-(M(t,49)*M(t,609)));
f_x_n(168-1)=(((log(M(t,664)))-(log(M(t-1,664))))-(M(t,345)+M(t,344)*(((log(M(t-1,664)))-(log(M(t-1-1,664))))-((M(t-1,338))-(M(t-1-1,338))))+M(t,346)*((log(M(t,473)))-(log(M(t-1,473))))+M(t,347)*((log(M(t-1,664))-M(t-1,338))-(log(M(t-1,473))-0.2744837*log(M(t-1,337))-0.0746919))+((M(t,338))-(M(t-1,338)))));
f_x_n(169-1)=(((log(M(t,644)))-(log(M(t-1,644))))-(0.0000208+0.610246*(((log(M(t-1,644)))-(log(M(t-1-1,644))))-((M(t-1,334))-(M(t-1-1,334))))+0.208469*((log(M(t,418)))-(log(M(t-1,418))))-0.007541*((M(t,477))-(M(t-1,477)))-0.078822*(log(M(t-1,644))-M(t-1,334)-log(M(t-1,426))-(2.159988+0.397879*log(M(t-1,418))))+((M(t,334))-(M(t-1,334)))));
f_x_n(170-1)=(M(t,418)-(M(t,417)/M(t,642)));
f_x_n(171-1)=(M(t,649)-(M(t,55)*M(t,639)));
f_x_n(172-1)=(((log(M(t,711)))-(log(M(t-1,711))))-(M(t,368)+M(t,369)*((log(M(t,211)))-(log(M(t-1,211))))+M(t,370)*((log(M(t,412)))-(log(M(t-1,412))))+M(t,371)*(log(M(t-1,711))-M(t-1,359)-log(M(t-1,211))-(6.614773+0.486314*log(M(t-1,73))-0.721832*log(M(t-1,412))))+((M(t,359))-(M(t-1,359)))));
f_x_n(173-1)=(M(t,676)-(M(t,57)*M(t,711)));
f_x_n(174-1)=(((log(M(t,726)))-(log(M(t-1,726))))-(M(t,376)+M(t,375)*(((log(M(t-1,726)))-(log(M(t-1-1,726))))-((M(t-1,361))-(M(t-1-1,361))))+M(t,377)*((log(M(t,211)))-(log(M(t-1,211))))+M(t,282)*(log(M(t-1,726))-log(M(t-1,211))-M(t-1,361)-(2.1310096+0.5645842*log(M(t-1,72))-0.1731084*log(M(t-1,412))))+((M(t,361))-(M(t-1,361)))));
f_x_n(175-1)=(((log(M(t,751)))-(log(M(t-1,751))))-(M(t,394)+M(t,393)*(((log(M(t-1,751)))-(log(M(t-1-1,751))))-((M(t-1,381))-(M(t-1-1,381))))+M(t,395)*((M(t,213))-(M(t-1,213)))+M(t,396)*M(t,214)+M(t,285)*(log(M(t-1,751))-M(t-1,381)-(-3.15763+log(M(t-1,533))-0.1288289*M(t-1,213)-0.1040831*log(M(t-1,380))))+((M(t,381))-(M(t-1,381)))));
f_x_n(176-1)=(((log(M(t,786)))-(log(M(t-1,786))))-(M(t,410)+M(t,408)*(((log(M(t-1,786)))-(log(M(t-1-1,786))))-((M(t-1,385))-(M(t-1-1,385))))+M(t,409)*(((log(M(t-2,786)))-(log(M(t-1-2,786))))-((M(t-2,385))-(M(t-1-2,385))))+M(t,411)*((log(M(t-1,801)))-(log(M(t-1-1,801))))+M(t,288)*(log(M(t-1,786))-M(t-1,385)-(log(M(t-1,801))-4.269267-0.578354*log(M(t-1,75))+0.007085*M(t-1,802)))+((M(t,385))-(M(t-1,385)))));
f_x_n(177-1)=(M(t,602)-(M(t,45)*M(t,607)));
f_x_n(178-1)=(M(t,495)-(M(t,30)*M(t,607)));
f_x_n(179-1)=(M(t,607)-(M(t,47)*M(t,243)));
f_x_n(180-1)=(log(M(t,612))-(log(M(t,241))+M(t,321)));
f_x_n(181-1)=(M(t,617)-(M(t,48)*M(t,607)));
f_x_n(182-1)=(M(t,642)-(M(t,53)*M(t,612)));
f_x_n(183-1)=(M(t,647)-(M(t,54)*M(t,637)));
f_x_n(184-1)=(((log(M(t,714)))-(log(M(t-1,714))))-(M(t,373)+M(t,374)*((log(M(t,416)))-(log(M(t-1,416))))+M(t,372)*(((log(M(t-1,714)))-(log(M(t-1-1,714))))-((M(t-1,360))-(M(t-1-1,360))))+M(t,281)*(log(M(t-1,714))-M(t-1,360)-(1.1376259+(1-0.6211299)*log(M(t-1,416))+0.6211299*log(M(t-1,577))-0.0037468*M(t-1,802)))+((M(t,360))-(M(t-1,360)))));
f_x_n(185-1)=(((log(M(t,709)))-(log(M(t-1,709))))-(M(t,366)+M(t,367)*((log(M(t,416)))-(log(M(t-1,416))))+M(t,365)*(((log(M(t-1,709)))-(log(M(t-1-1,709))))-((M(t-1,358))-(M(t-1-1,358))))+M(t,280)*(log(M(t-1,709))-M(t-1,358)-(0.352685+(1-0.645295)*log(M(t-1,416))+0.645295*log(M(t-1,577))-0.003345*M(t-1,802)))+((M(t,358))-(M(t-1,358)))));
f_x_n(186-1)=(((log(M(t,674)))-(log(M(t-1,674))))-(M(t,364)+M(t,362)*((log(M(t,18)))-(log(M(t-1,18))))+M(t,363)*((log(M(t-1,18)))-(log(M(t-1-1,18))))+M(t,279)*(log(M(t-1,674))-M(t-1,357)-(1.2691946+0.8190017*log(M(t-1,18))))+((M(t,357))-(M(t-1,357)))));
f_x_n(187-1)=(M(t,689)-(M(t,58)*M(t,612)));
f_x_n(188-1)=(M(t,719)-(M(t,59)*M(t,612)));
f_x_n(189-1)=(((log(M(t,774)))-(log(M(t-1,774))))-(M(t,406)+M(t,407)*((log(M(t,415)))-(log(M(t-1,415))))+M(t,405)*(((log(M(t-1,774)))-(log(M(t-1-1,774))))-((M(t-1,384))-(M(t-1-1,384))))+M(t,287)*(log(M(t-1,774))-M(t-1,384)-(1.8846238+(1-0.3247679)*log(M(t-1,415))+0.3247679*log(M(t-1,577))-0.0044649*M(t-1,802)))+((M(t,384))-(M(t-1,384)))));
f_x_n(190-1)=(((log(M(t,734)))-(log(M(t-1,734))))-(M(t,387)+M(t,386)*((log(M(t,18)))-(log(M(t-1,18))))+M(t,283)*(log(M(t-1,734))-M(t-1,378)-(1.2435768+0.8291449*log(M(t-1,18))))+((M(t,378))-(M(t-1,378)))));
f_x_n(191-1)=(((log(M(t,749)))-(log(M(t-1,749))))-(M(t,392)+M(t,388)*(((log(M(t-2,749)))-(log(M(t-1-2,749))))-((M(t-2,379))-(M(t-1-2,379))))+M(t,389)*(((log(M(t-3,749)))-(log(M(t-1-3,749))))-((M(t-3,379))-(M(t-1-3,379))))+M(t,390)*((log(M(t,18)))-(log(M(t-1,18))))+M(t,391)*((log(M(t-3,18)))-(log(M(t-1-3,18))))+M(t,284)*(log(M(t-1,749))-M(t-1,379)-(1.216277+0.841455*log(M(t-1,18))))+((M(t,379))-(M(t-1,379)))));
f_x_n(192-1)=(M(t,779)-(M(t,63)*M(t,612)));
f_x_n(193-1)=(M(t,350)-(M(t,353)+M(t,352)*(M(t-1,350)-M(t-1,351))+M(t,354)*((log(M(t-1,538)))-(log(M(t-1-1,538))))+M(t,355)*((log(M(t-1,686)))-(log(M(t-1-1,686))))+M(t,356)*((log(M(t-2,686)))-(log(M(t-1-2,686))))+M(t,351)));
f_x_n(194-1)=(M(t,465)-(M(t,37)*M(t,461)));
f_x_n(195-1)=(M(t,477)-(100*(M(t,476)-M(t,471))/M(t,476)));
f_x_n(196-1)=(M(t,474)-(M(t,70)*M(t,473)));
f_x_n(197-1)=(log(M(t,473))-(log((M(t,219)+M(t-1,219))/2)+M(t,221)));
f_x_n(198-1)=(((log(M(t,428))-0.15*log(M(t,422)))-(log(M(t-1,428))-0.15*log(M(t-1,422))))-(M(t,431)+M(t,430)*((log(M(t-4,428))-M(t-4,429)-0.15*log(M(t-4,422)))-(log(M(t-1-4,428))-M(t-1-4,429)-0.15*log(M(t-1-4,422))))+M(t,433)*((M(t-1,477))-(M(t-1-1,477)))+M(t,432)*((log(M(t-1,241))-log(M(t-1,485)))-(log(M(t-1-1,241))-log(M(t-1-1,485))))+M(t,289)*(log(M(t-1,428))-M(t-1,429)-0.15*log(M(t-1,422)))+M(t,291)*log(M(t-1,485))+M(t,290)*(log(M(t-1,241))-log(M(t-1,485)))+M(t,295)*M(t,802)+M(t,292)*M(t,236)+M(t,293)*M(t,237)+M(t,294)*M(t,238)+((M(t,429))-(M(t-1,429)))));
f_x_n(199-1)=(((log(M(t,468)))-(log(M(t-1,468))))-(M(t,200)+M(t,201)*((M(t,212))-(M(t-1,212)))+M(t,202)*((log(M(t-4,501)))-(log(M(t-1-4,501))))+M(t,269)*(log(M(t-1,468))-M(t-1,199)-(-2.196468+log(M(t-5,501))+0.278456*M(t-1,212)+0.004908*M(t-1,811)))+((M(t,199))-(M(t-1,199)))));
f_x_n(200-1)=(((log(M(t,470)))-(log(M(t-1,470))))-(M(t,206)+M(t,207)*((log(M(t,475)))-(log(M(t-1,475))))+M(t,272)*(log(M(t-1,470))-M(t-1,204)-(-4.588489+log(M(t-1,791))+log(M(t-1,241))-0.184047*log(M(t-1,475))))+((M(t,204))-(M(t-1,204)))));
f_x_n(201-1)=(((log(M(t,243)))-(log(M(t-1,243))))-(M(t,242)+M(t,246)*M(t,235)+M(t,245)*(((log(M(t-1,243)))-(log(M(t-1-1,243))))-((M(t-1,244))-(M(t-1-1,244))))+M(t,247)*((log(M(t-1,243))-M(t-1,244))-log(M(t-1,764)))+M(t,248)*(log(M(t-1,764))-log(M(t-1,577)))+((M(t,244))-(M(t-1,244)))));
f_x_n(202-1)=(((log(M(t,249)))-(log(M(t-1,249))))-(M(t,254)+M(t,251)*(((log(M(t-3,249)))-(log(M(t-1-3,249))))-((M(t-3,250))-(M(t-1-3,250))))+M(t,252)*((log(M(t,18)+M(t,806)))-(log(M(t-1,18)+M(t-1,806))))+M(t,253)*((log(M(t-2,18)+M(t-2,806)))-(log(M(t-1-2,18)+M(t-1-2,806))))+M(t,274)*(log(M(t-1,249))-M(t-1,250)-(3.302787+0.15*log(M(t-1,18)+M(t-1,806))+0.004329*M(t,802)))+((M(t,250))-(M(t-1,250)))));
return(f_x_n);
}

// [[Rcpp::export]]
mat prologue_jacobian_f(arma::mat & M, int & t){
mat Jacobian_n(202,202,arma::fill::zeros);
Jacobian_n.elem( arma::uvec("162 365 561 1122 1325 1516 1719 1922 2125 2328 2531 2735 2936 3140 3343 3573 3776 3967 4170 4373 4576 4779 4982 5186 5387 5591 5794 5985 5997 6188 6376 6391 6579 6594 6783 6797 6986 7000 7189 7203 7388 7594 7608 7798 7812 7999 8013 8203 8419 8622 9048 10867 11067 11268 11481 11871 12071 12274 12515 12675 12921 13080 13355 13558 13758 13963 14227 14519 14610 14753 14974 15158 15436 15498 15819 15897 16166 16367 16567 16770 16982 17180 17383 17587 17785 17990 18265 18327 18648 18726 19004 19207 19407 19613 19816 20016 20221 20488 20780 20871 21172 21237 21500 21681 21844 22249 22511 22804 22894 23194 23260 23463 23669 23872 24128 24310 24479 24735 25027 25119 25490 25746 26038 26130 26430 26494 26697 26900 27137 27513 27772 27949 28122 28376 28761 29058 29127 29330 29585 29640 29970 30039 30345 30599 30890 30984 31158 31409 31460 31794 31859 32166 32369 32564 32818 32873 33203 33272 33575 33829 34214 34589 34931 34992 35227 35611 35854 36037 36213 36613 36816 37023 37269 37654 38038 38238 38441 38635 38838 39246 39581 39648 39877 40198 40401 40604") ) = arma::vec(186,arma::fill::ones);
Jacobian_n.elem( arma::uvec("1149 1527 1543 1746 1931 1949 2152 2355 2558 2762 2963 3167 3370 3978 4382 6390 6794 8406 8609 8812 9288 9491 9690 9896 10301 10494 10688 12475 13079 14287 14686 20549 20948 21558 21755 24184 24381 27822 28019 28429 28430 28828 28829 30650 30652 31049 31051 32872 33271 33883 34282") ) = arma::vec(51,arma::fill::ones) - 2;
Jacobian_n(64-1,76-1)=(-M(t,518));
Jacobian_n(64-1,80-1)=(-M(t,514));
Jacobian_n(65-1,90-1)=(-M(t,569));
Jacobian_n(65-1,94-1)=(-M(t,565));
Jacobian_n(66-1,101-1)=(-M(t,604));
Jacobian_n(66-1,105-1)=(-M(t,600));
Jacobian_n(67-1,70-1)=(-M(t,497));
Jacobian_n(68-1,106-1)=(-M(t,609));
Jacobian_n(69-1,111-1)=(-M(t,619));
Jacobian_n(69-1,115-1)=(-M(t,615));
Jacobian_n(70-1,134-1)=(-M(t,664));
Jacobian_n(70-1,136-1)=(-M(t,660));
Jacobian_n(71-1,119-1)=(-M(t,639));
Jacobian_n(72-1,122-1)=(-M(t,644));
Jacobian_n(72-1,126-1)=(-M(t,640));
Jacobian_n(73-1,127-1)=(-M(t,649));
Jacobian_n(73-1,131-1)=(-M(t,645));
Jacobian_n(74-1,137-1)=(-M(t,671));
Jacobian_n(75-1,146-1)=(-M(t,686));
Jacobian_n(75-1,150-1)=(-M(t,682));
Jacobian_n(76-1,162-1)=(-M(t,711));
Jacobian_n(76-1,166-1)=(-M(t,707));
Jacobian_n(77-1,167-1)=(-M(t,716));
Jacobian_n(77-1,171-1)=(-M(t,712));
Jacobian_n(78-1,140-1)=(-M(t,676));
Jacobian_n(78-1,144-1)=(-M(t,672));
Jacobian_n(79-1,151-1)=(-M(t,691));
Jacobian_n(80-1,174-1)=(-M(t,726));
Jacobian_n(80-1,176-1)=(-M(t,722));
Jacobian_n(81-1,155-1)=(-M(t,696));
Jacobian_n(81-1,159-1)=(-M(t,692));
Jacobian_n(82-1,177-1)=(-M(t,731));
Jacobian_n(83-1,184-1)=(-M(t,751));
Jacobian_n(83-1,188-1)=(-M(t,747));
Jacobian_n(84-1,197-1)=(-M(t,786));
Jacobian_n(84-1,199-1)=(-M(t,782));
Jacobian_n(85-1,78-1)=(-(0.01*M(t,518)));
Jacobian_n(85-1,80-1)=(-(0.01*M(t,516)));
Jacobian_n(86-1,92-1)=(-(0.01*M(t,569)));
Jacobian_n(86-1,94-1)=(-(0.01*M(t,567)));
Jacobian_n(87-1,103-1)=(-(0.01*M(t,604)));
Jacobian_n(87-1,105-1)=(-(0.01*M(t,602)));
Jacobian_n(88-1,72-1)=(-(0.01*M(t,497)));
Jacobian_n(90-1,113-1)=(-(0.01*M(t,619)));
Jacobian_n(90-1,115-1)=(-(0.01*M(t,617)));
Jacobian_n(92-1,124-1)=(-(0.01*M(t,644)));
Jacobian_n(92-1,126-1)=(-(0.01*M(t,642)));
Jacobian_n(93-1,129-1)=(-(0.01*M(t,649)));
Jacobian_n(93-1,131-1)=(-(0.01*M(t,647)));
Jacobian_n(94-1,148-1)=(-(0.01*M(t,686)));
Jacobian_n(94-1,150-1)=(-(0.01*M(t,684)));
Jacobian_n(95-1,164-1)=(-(0.01*M(t,711)));
Jacobian_n(95-1,166-1)=(-(0.01*M(t,709)));
Jacobian_n(96-1,169-1)=(-(0.01*M(t,716)));
Jacobian_n(96-1,171-1)=(-(0.01*M(t,714)));
Jacobian_n(97-1,142-1)=(-(0.01*M(t,676)));
Jacobian_n(97-1,144-1)=(-(0.01*M(t,674)));
Jacobian_n(98-1,153-1)=(-(0.01*M(t,691)));
Jacobian_n(100-1,157-1)=(-(0.01*M(t,696)));
Jacobian_n(100-1,159-1)=(-(0.01*M(t,694)));
Jacobian_n(102-1,186-1)=(-(0.01*M(t,751)));
Jacobian_n(102-1,188-1)=(-(0.01*M(t,749)));
Jacobian_n(103-1,107-1)=(-(100/M(t-1,788)));
Jacobian_n(104-1,112-1)=(-(100/M(t-1,788)));
Jacobian_n(105-1,120-1)=(-(100/M(t-1,788)));
Jacobian_n(106-1,123-1)=(-(100/M(t-1,788)));
Jacobian_n(107-1,128-1)=(-(100/M(t-1,788)));
Jacobian_n(108-1,138-1)=(-(100/M(t-1,788)));
Jacobian_n(109-1,163-1)=(-(100/M(t-1,788)));
Jacobian_n(110-1,152-1)=(-(100/M(t-1,788)));
Jacobian_n(111-1,178-1)=(100/M(t-1,788));
Jacobian_n(112-1,185-1)=(100/M(t-1,788));
Jacobian_n(113-1,71-1)=(-(100/M(t-1,788)));
Jacobian_n(115-1,106-1)=(100*(M(t,813)*(M(t-1,609)+M(t-2,609)+M(t-3,609)+M(t-4,609))/(M(t,787)*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))));
Jacobian_n(115-1,108-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(115-1,200-1)=(-((M(t,813)*(100*(M(t,605)*(M(t-1,609)+M(t-2,609)+M(t-3,609)+M(t-4,609))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))-100*(M(t,608)/M(t-1,791)))-100*(M(t,608)*(1-M(t,813))/M(t-1,791)))/pow(M(t,787),2)));
Jacobian_n(116-1,111-1)=(100*(M(t,813)*(M(t-1,619)+M(t-2,619)+M(t-3,619)+M(t-4,619))/(M(t,787)*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))));
Jacobian_n(116-1,114-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(116-1,200-1)=(-((M(t,813)*(100*(M(t,615)*(M(t-1,619)+M(t-2,619)+M(t-3,619)+M(t-4,619))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))-100*(M(t,618)/M(t-1,791)))-100*(M(t,618)*(1-M(t,813))/M(t-1,791)))/pow(M(t,787),2)));
Jacobian_n(117-1,134-1)=(100*(M(t,813)*(M(t-1,664)+M(t-2,664)+M(t-3,664)+M(t-4,664))/(M(t,787)*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))));
Jacobian_n(117-1,135-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(117-1,200-1)=(-((M(t,813)*(100*(M(t,660)*(M(t-1,664)+M(t-2,664)+M(t-3,664)+M(t-4,664))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))-100*(M(t,663)/M(t-1,791)))-100*(M(t,663)*(1-M(t,813))/M(t-1,791)))/pow(M(t,787),2)));
Jacobian_n(118-1,119-1)=(100*(M(t,813)*(M(t-1,639)+M(t-2,639)+M(t-3,639)+M(t-4,639))/(M(t,787)*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))));
Jacobian_n(118-1,121-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(118-1,200-1)=(-((M(t,813)*(100*(M(t,635)*(M(t-1,639)+M(t-2,639)+M(t-3,639)+M(t-4,639))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))-100*(M(t,638)/M(t-1,791)))-100*(M(t,638)*(1-M(t,813))/M(t-1,791)))/pow(M(t,787),2)));
Jacobian_n(119-1,122-1)=(100*(M(t,813)*(M(t-1,644)+M(t-2,644)+M(t-3,644)+M(t-4,644))/(M(t,787)*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))));
Jacobian_n(119-1,125-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(119-1,200-1)=(-((M(t,813)*(100*(M(t,640)*(M(t-1,644)+M(t-2,644)+M(t-3,644)+M(t-4,644))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))-100*(M(t,643)/M(t-1,791)))-100*(M(t,643)*(1-M(t,813))/M(t-1,791)))/pow(M(t,787),2)));
Jacobian_n(120-1,127-1)=(100*(M(t,813)*(M(t-1,649)+M(t-2,649)+M(t-3,649)+M(t-4,649))/(M(t,787)*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))));
Jacobian_n(120-1,130-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(120-1,200-1)=(-((M(t,813)*(100*(M(t,645)*(M(t-1,649)+M(t-2,649)+M(t-3,649)+M(t-4,649))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))-100*(M(t,648)/M(t-1,791)))-100*(M(t,648)*(1-M(t,813))/M(t-1,791)))/pow(M(t,787),2)));
Jacobian_n(121-1,137-1)=(100*(M(t,813)*(M(t-1,671)+M(t-2,671)+M(t-3,671)+M(t-4,671))/(M(t,787)*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))));
Jacobian_n(121-1,139-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(121-1,200-1)=(-((M(t,813)*(100*(M(t,667)*(M(t-1,671)+M(t-2,671)+M(t-3,671)+M(t-4,671))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))-100*(M(t,670)/M(t-1,791)))-100*(M(t,670)*(1-M(t,813))/M(t-1,791)))/pow(M(t,787),2)));
Jacobian_n(122-1,162-1)=(100*(M(t,813)*(M(t-1,711)+M(t-2,711)+M(t-3,711)+M(t-4,711))/(M(t,787)*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))));
Jacobian_n(122-1,165-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(122-1,200-1)=(-((M(t,813)*(100*(M(t,707)*(M(t-1,711)+M(t-2,711)+M(t-3,711)+M(t-4,711))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))-100*(M(t,710)/M(t-1,791)))-100*(M(t,710)*(1-M(t,813))/M(t-1,791)))/pow(M(t,787),2)));
Jacobian_n(123-1,151-1)=(100*(M(t,813)*(M(t-1,691)+M(t-2,691)+M(t-3,691)+M(t-4,691))/(M(t,787)*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))));
Jacobian_n(123-1,154-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(123-1,200-1)=(-((M(t,813)*(100*(M(t,687)*(M(t-1,691)+M(t-2,691)+M(t-3,691)+M(t-4,691))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))-100*(M(t,690)/M(t-1,791)))-100*(M(t,690)*(1-M(t,813))/M(t-1,791)))/pow(M(t,787),2)));
Jacobian_n(124-1,174-1)=(100*(M(t,813)*(M(t-1,726)+M(t-2,726)+M(t-3,726)+M(t-4,726))/(M(t,787)*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))));
Jacobian_n(124-1,175-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(124-1,200-1)=(-((M(t,813)*(100*(M(t,722)*(M(t-1,726)+M(t-2,726)+M(t-3,726)+M(t-4,726))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))-100*(M(t,725)/M(t-1,791)))-100*(M(t,725)*(1-M(t,813))/M(t-1,791)))/pow(M(t,787),2)));
Jacobian_n(125-1,177-1)=(100*(M(t,813)*(M(t-1,731)+M(t-2,731)+M(t-3,731)+M(t-4,731))/(M(t,787)*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))));
Jacobian_n(125-1,179-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(125-1,200-1)=(-((M(t,813)*(100*(M(t,727)*(M(t-1,731)+M(t-2,731)+M(t-3,731)+M(t-4,731))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))-100*(M(t,730)/M(t-1,791)))-100*(M(t,730)*(1-M(t,813))/M(t-1,791)))/pow(M(t,787),2)));
Jacobian_n(126-1,184-1)=(100*(M(t,813)*(M(t-1,751)+M(t-2,751)+M(t-3,751)+M(t-4,751))/(M(t,787)*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))));
Jacobian_n(126-1,187-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(126-1,200-1)=(-((M(t,813)*(100*(M(t,747)*(M(t-1,751)+M(t-2,751)+M(t-3,751)+M(t-4,751))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))-100*(M(t,750)/M(t-1,791)))-100*(M(t,750)*(1-M(t,813))/M(t-1,791)))/pow(M(t,787),2)));
Jacobian_n(127-1,197-1)=(100*(M(t,813)*(M(t-1,786)+M(t-2,786)+M(t-3,786)+M(t-4,786))/(M(t,787)*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))));
Jacobian_n(127-1,198-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(127-1,200-1)=(-((M(t,813)*(100*(M(t,782)*(M(t-1,786)+M(t-2,786)+M(t-3,786)+M(t-4,786))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))-100*(M(t,785)/M(t-1,791)))-100*(M(t,785)*(1-M(t,813))/M(t-1,791)))/pow(M(t,787),2)));
Jacobian_n(128-1,70-1)=(100*(M(t,813)*(M(t-1,497)+M(t-2,497)+M(t-3,497)+M(t-4,497))/(M(t,787)*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))));
Jacobian_n(128-1,73-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(128-1,200-1)=(-((M(t,813)*(100*(M(t,493)*(M(t-1,497)+M(t-2,497)+M(t-3,497)+M(t-4,497))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))-100*(M(t,496)/M(t-1,791)))-100*(M(t,496)*(1-M(t,813))/M(t-1,791)))/pow(M(t,787),2)));
Jacobian_n(157-1,50-1)=(-(M(t,67)/(M(t,66)+M(t,67))));
Jacobian_n(162-1,150-1)=(-(1/M(t,211)));
Jacobian_n(163-1,138-1)=-0.001;
Jacobian_n(163-1,178-1)=0.001;
Jacobian_n(164-1,152-1)=-0.001;
Jacobian_n(164-1,185-1)=0.001;
Jacobian_n(166-1,4-1)=(-M(t,460));
Jacobian_n(166-1,61-1)=(-M(t,31));
Jacobian_n(168-1,136-1)=(1/M(t,664));
Jacobian_n(169-1,57-1)=(-(0.208469/M(t,418)));
Jacobian_n(169-1,126-1)=(1/M(t,644));
Jacobian_n(170-1,124-1)=(M(t,417)/pow(M(t,642),2));
Jacobian_n(172-1,166-1)=(1/M(t,711));
Jacobian_n(173-1,166-1)=(-M(t,57));
Jacobian_n(174-1,176-1)=(1/M(t,726));
Jacobian_n(175-1,188-1)=(1/M(t,751));
Jacobian_n(176-1,199-1)=(1/M(t,786));
Jacobian_n(179-1,5-1)=(-M(t,243));
Jacobian_n(180-1,110-1)=(1/M(t,612));
Jacobian_n(182-1,110-1)=(-M(t,53));
Jacobian_n(184-1,56-1)=(-(M(t,374)/M(t,416)));
Jacobian_n(184-1,169-1)=(1/M(t,714));
Jacobian_n(185-1,56-1)=(-(M(t,367)/M(t,416)));
Jacobian_n(185-1,164-1)=(1/M(t,709));
Jacobian_n(186-1,3-1)=(-(M(t,362)/M(t,18)));
Jacobian_n(186-1,142-1)=(1/M(t,674));
Jacobian_n(187-1,110-1)=(-M(t,58));
Jacobian_n(188-1,110-1)=(-M(t,59));
Jacobian_n(189-1,55-1)=(-(M(t,407)/M(t,415)));
Jacobian_n(189-1,194-1)=(1/M(t,774));
Jacobian_n(190-1,3-1)=(-(M(t,386)/M(t,18)));
Jacobian_n(190-1,181-1)=(1/M(t,734));
Jacobian_n(191-1,3-1)=(-(M(t,390)/M(t,18)));
Jacobian_n(191-1,186-1)=(1/M(t,749));
Jacobian_n(192-1,110-1)=(-M(t,63));
Jacobian_n(195-1,63-1)=(100/M(t,476));
Jacobian_n(195-1,66-1)=(-((100-100*((M(t,476)-M(t,471))/M(t,476)))/M(t,476)));
Jacobian_n(198-1,58-1)=(1/M(t,428));
Jacobian_n(200-1,65-1)=(-(M(t,207)/M(t,475)));
Jacobian_n(202-1,3-1)=(-(M(t,252)/(M(t,18)+M(t,806))));
Jacobian_n(202-1,50-1)=(1/M(t,249));
return(Jacobian_n);
}

// [[Rcpp::export]]
arma::vec heart_equations_f(arma::mat& M, int& t){
arma::vec f_x_n(99);
f_x_n(1-1)=(M(t,790)-(M(t,791)*M(t,787)));
f_x_n(2-1)=(M(t,795)-(M(t,796)*M(t,792)));
f_x_n(3-1)=(M(t,537)-(M(t,538)*M(t,534)));
f_x_n(4-1)=(M(t,553)-(M(t,554)*M(t,550)));
f_x_n(5-1)=(M(t,593)-(M(t,594)*M(t,590)));
f_x_n(6-1)=(M(t,491)-(M(t,492)*M(t,488)));
f_x_n(7-1)=(M(t,481)-(M(t,482)*M(t,478)));
f_x_n(8-1)=(M(t,486)-(M(t,487)*M(t,483)));
f_x_n(9-1)=(M(t,613)-(M(t,614)*M(t,610)));
f_x_n(10-1)=(M(t,628)-(M(t,629)*M(t,625)));
f_x_n(11-1)=(M(t,658)-(M(t,659)*M(t,655)));
f_x_n(12-1)=(M(t,633)-(M(t,634)*M(t,630)));
f_x_n(13-1)=(M(t,680)-(M(t,681)*M(t,677)));
f_x_n(14-1)=(M(t,720)-(M(t,721)*M(t,717)));
f_x_n(15-1)=(M(t,740)-(M(t,741)*M(t,737)));
f_x_n(16-1)=(M(t,770)-(M(t,771)*M(t,767)));
f_x_n(17-1)=(M(t,775)-(M(t,776)*M(t,772)));
f_x_n(18-1)=(M(t,735)-(M(t,736)*M(t,732)));
f_x_n(19-1)=(M(t,780)-(M(t,781)*M(t,777)));
f_x_n(20-1)=(M(t,765)-(M(t,766)*M(t,762)));
f_x_n(21-1)=(M(t,755)-(M(t,756)*M(t,752)));
f_x_n(22-1)=(M(t,788)-(M(t,791)*M(t,789)/100));
f_x_n(23-1)=(M(t,793)-(M(t,796)*M(t,794)/100));
f_x_n(24-1)=(M(t,594)*M(t,592)/100-(M(t,591)));
f_x_n(25-1)=(M(t,489)-(M(t,492)*M(t,490)/100));
f_x_n(26-1)=(M(t,479)-(M(t,482)*M(t,480)/100));
f_x_n(27-1)=(M(t,611)-(M(t,614)*M(t,612)/100));
f_x_n(28-1)=(M(t,626)-(M(t,629)*M(t,627)/100));
f_x_n(29-1)=(M(t,656)-(M(t,659)*M(t,657)/100));
f_x_n(30-1)=(M(t,661)-(M(t,664)*M(t,662)/100));
f_x_n(31-1)=(M(t,631)-(M(t,634)*M(t,632)/100));
f_x_n(32-1)=(M(t,723)-(M(t,726)*M(t,724)/100));
f_x_n(33-1)=(M(t,718)-(M(t,721)*M(t,719)/100));
f_x_n(34-1)=(M(t,773)-(M(t,776)*M(t,774)/100));
f_x_n(35-1)=(M(t,733)-(M(t,736)*M(t,734)/100));
f_x_n(36-1)=(M(t,783)-(M(t,786)*M(t,784)/100));
f_x_n(37-1)=(M(t,778)-(M(t,781)*M(t,779)/100));
f_x_n(38-1)=(M(t,763)-(M(t,766)*M(t,764)/100));
f_x_n(39-1)=(M(t,753)-(M(t,756)*M(t,754)/100));
f_x_n(40-1)=(log(M(t,789))-log(M(t,794))-(M(t,349)));
f_x_n(41-1)=(log(M(t,791))-log(M(t,796))-(M(t,350)));
f_x_n(42-1)=(M(t,186)-((M(t,813))*(100*(M(t,790)/M(t,787)-(M(t-1,790)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,787)/M(t,787)-(M(t-1,787)/M(t-1,787)))*(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,790)/M(t,787)-(M(t-1,790)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(43-1)=(M(t,163)-((M(t,813))*(100*(M(t,613)/M(t,787)-(M(t-1,613)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,610)/M(t,787)-(M(t-1,610)/M(t-1,787)))*(M(t-1,614)+M(t-2,614)+M(t-3,614)+M(t-4,614))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,613)/M(t,787)-(M(t-1,613)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(44-1)=(M(t,170)-((M(t,813))*(100*(M(t,653)/M(t,787)-(M(t-1,653)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,650)/M(t,787)-(M(t-1,650)/M(t-1,787)))*(M(t-1,654)+M(t-2,654)+M(t-3,654)+M(t-4,654))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,653)/M(t,787)-(M(t-1,653)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(45-1)=(M(t,166)-((M(t,813))*(100*(M(t,633)/M(t,787)-(M(t-1,633)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,630)/M(t,787)-(M(t-1,630)/M(t-1,787)))*(M(t-1,634)+M(t-2,634)+M(t-3,634)+M(t-4,634))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,633)/M(t,787)-(M(t-1,633)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(46-1)=(M(t,173)-(M(t,186)-M(t,181)-M(t,175)-M(t,170)-M(t,166)-M(t,168)-M(t,167)-M(t,169)-M(t,163)-M(t,162)-M(t,164)));
f_x_n(47-1)=(M(t,175)-((M(t,813))*(100*(M(t,680)/M(t,787)-(M(t-1,680)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,677)/M(t,787)-(M(t-1,677)/M(t-1,787)))*(M(t-1,681)+M(t-2,681)+M(t-3,681)+M(t-4,681))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,680)/M(t,787)-(M(t-1,680)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(48-1)=(-M(t,181)-((M(t,813))*(100*(M(t,740)/M(t,787)-(M(t-1,740)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,737)/M(t,787)-(M(t-1,737)/M(t-1,787)))*(M(t-1,741)+M(t-2,741)+M(t-3,741)+M(t-4,741))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,740)/M(t,787)-(M(t-1,740)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(49-1)=(M(t,790)-(M(t,608)+M(t,613)+M(t,618)+M(t,653)+M(t,633)+M(t,638)+M(t,643)+M(t,648)+M(t,666)+M(t,680)-M(t,740)));
f_x_n(50-1)=(M(t,795)-(M(t,608)+M(t,613)+M(t,618)+M(t,653)+M(t,633)+M(t,638)+M(t,643)+M(t,648)+M(t,680)-M(t,740)));
f_x_n(51-1)=(M(t,532)-(M(t,608)+M(t,613)+M(t,618)+M(t,653)+M(t,633)+M(t,638)+M(t,643)+M(t,648)+M(t,666)));
f_x_n(52-1)=(M(t,537)-(M(t,532)-M(t,666)));
f_x_n(53-1)=(M(t,553)-(M(t,486)+M(t,593)));
f_x_n(54-1)=(M(t,491)-(M(t,481)+M(t,486)+M(t,496)));
f_x_n(55-1)=(M(t,628)-(M(t,653)+M(t,633)+M(t,638)+M(t,643)+M(t,648)));
f_x_n(56-1)=(M(t,653)-(M(t,658)+M(t,663)));
f_x_n(57-1)=(M(t,680)-(M(t,725)+M(t,710)+M(t,670)+M(t,690)+M(t,720)));
f_x_n(58-1)=(M(t,740)-(M(t,750)+M(t,730)+M(t,770)+M(t,785)+M(t,780)));
f_x_n(59-1)=(M(t,770)-(M(t,735)+M(t,775)));
f_x_n(60-1)=(M(t,765)-(M(t,740)-M(t,750)-M(t,735)));
f_x_n(61-1)=(M(t,755)-(M(t,750)+M(t,735)));
f_x_n(62-1)=(M(t,793)-(M(t,606)+M(t,611)+M(t,616)+M(t,651)+M(t,631)+M(t,636)+M(t,641)+M(t,646)+M(t,678)-M(t,738)));
f_x_n(63-1)=(M(t,489)-(M(t,788)-M(t,510)));
f_x_n(64-1)=(M(t,626)-(M(t,651)+M(t,641)+M(t,636)+M(t,631)+M(t,646)));
f_x_n(65-1)=(M(t,651)-(M(t,656)+M(t,661)));
f_x_n(66-1)=(M(t,678)-(M(t,723)+M(t,708)+M(t,668)+M(t,688)+M(t,718)));
f_x_n(67-1)=(M(t,738)-(M(t,748)+M(t,728)+M(t,768)+M(t,783)+M(t,778)));
f_x_n(68-1)=(M(t,768)-(M(t,733)+M(t,773)));
f_x_n(69-1)=(M(t,763)-(M(t,738)-M(t,748)-M(t,733)));
f_x_n(70-1)=(M(t,753)-(M(t,748)+M(t,733)));
f_x_n(71-1)=(M(t,458)-(M(t,434)*M(t,473)));
f_x_n(72-1)=(M(t,423)-(M(t,487)/M(t,473)));
f_x_n(73-1)=(M(t,195)-((M(t,458)+M(t,463)+M(t,466))/M(t,554)));
f_x_n(74-1)=(M(t,198)-(M(t,591)/M(t,554)));
f_x_n(75-1)=(M(t,500)-(M(t,451)+M(t,501)+M(t,470)-M(t,469)-M(t,468)+M(t,502)));
f_x_n(76-1)=(M(t,501)-(M(t,508)+M(t,457)+M(t,458)+M(t,461)));
f_x_n(77-1)=(M(t,594)-(M(t,43)*M(t,487)));
f_x_n(78-1)=(M(t,492)-(M(t,29)*M(t,791)));
f_x_n(79-1)=(M(t,482)-(M(t,28)*M(t,492)));
f_x_n(80-1)=(((log(M(t,614)))-(log(M(t-1,614))))-(M(t,325)+M(t,324)*M(t,17)+M(t,323)*M(t,16)+M(t,329)*M(t,265)+M(t,328)*M(t,264)+M(t,326)*M(t,225)+M(t,327)*M(t,239)+M(t,330)*((log(M(t,425)))-(log(M(t-1,425))))+M(t,331)*((log(M(t-1,425)))-(log(M(t-1-1,425))))+M(t,332)*((M(t,477))-(M(t-1,477)))+M(t,333)*((M(t,803))-(M(t-1,803)))+M(t,277)*(log(M(t-1,614))-M(t-1,322)-1*log(M(t-1,425)))+((M(t,322))-(M(t-1,322)))));
f_x_n(81-1)=(((log(M(t,659)))-(log(M(t-1,659))))-(-0.002589+0.286146*(((log(M(t-1,659)))-(log(M(t-1-1,659))))-((M(t-1,336))-(M(t-1-1,336))))+1.601567*((log(M(t,487)))-(log(M(t-1,487))))-0.088346*(log(M(t-1,659))-log(M(t-1,487))-(-1.837962-0.018408*M(t-1,190))-M(t-1,336))+((M(t,336))-(M(t-1,336)))));
f_x_n(82-1)=(M(t,634)-(M(t,51)*M(t,629)));
f_x_n(83-1)=(M(t,721)-(M(t,60)*M(t,681)));
f_x_n(84-1)=(((log(M(t,771)))-(log(M(t-1,771))))-(M(t,400)+M(t,401)*((log(M(t,538)))-(log(M(t-1,538))))+M(t,403)*(M(t,173)/100)+M(t,404)*((log(M(t,711)))-(log(M(t-1,711))))+M(t,402)*(log(M(t-1,771))-M(t-1,383)-log(M(t-1,801))-(-0.903874-0.255446*log(M(t-1,74))+0.759046*log(M(t-1,309))))+((M(t,383))-(M(t-1,383)))));
f_x_n(85-1)=(M(t,736)-(M(t,62)*M(t,771)));
f_x_n(86-1)=(M(t,781)-(M(t,64)*M(t,741)));
f_x_n(87-1)=(((log(M(t,577)))-(log(M(t-1,577))))-(M(t,311)+M(t,312)*(((log(M(t-1,577)))-(log(M(t-1-1,577))))-((M(t-1,310))-(M(t-1-1,310))))+M(t,313)*(((log(M(t-3,577)))-(log(M(t-1-3,577))))-((M(t-3,310))-(M(t-1-3,310))))+M(t,314)*((log(M(t,195)))-(log(M(t-1,195))))+M(t,315)*((log(M(t,198)))-(log(M(t-1,198))))+M(t,275)*(log(M(t-1,577))-M(t-1,310)-(log(M(t-1,191))+4.754381+0.000625*M(t-1,802)-0.001205*M(t-1,804)))+((M(t,310))-(M(t-1,310)))));
f_x_n(88-1)=(((log(M(t,592)))-(log(M(t-1,592))))-(M(t,318)+M(t,317)*(((log(M(t-1,592)))-(log(M(t-1-1,592))))-((M(t-1,316))-(M(t-1-1,316))))+M(t,319)*((log(M(t,764)))-(log(M(t-1,764))))+M(t,320)*((log(M(t,754)))-(log(M(t-1,754))))+M(t,276)*(log(M(t-1,592))-M(t-1,316)-(0.779428*log(M(t-1,577))+(1-0.779428)*log(M(t-1,739))+0.00175*M(t-1,805)-0.010876))+((M(t,316))-(M(t-1,316)))));
f_x_n(89-1)=(M(t,480)-(M(t,27)*M(t,490)));
f_x_n(90-1)=(M(t,510)-(M(t,38)*M(t,788)));
f_x_n(91-1)=(((log(M(t,657)))-(log(M(t-1,657))))-(M(t,340)+M(t,339)*((log(M(t-1,657))-M(t-1,335))-(log(M(t-1-1,657))-M(t-1-1,335)))+M(t,341)*((log(M(t,577)))-(log(M(t-1,577))))+M(t,342)*((log(M(t-4,577)))-(log(M(t-1-4,577))))+M(t,343)*((log(M(t,764)))-(log(M(t-1,764))))+M(t,278)*(log(M(t-1,657))-M(t-1,335)-(0.478054*log(M(t-1,577))+(1-0.478054)*log(M(t-1,764))))+((M(t,335))-(M(t-1,335)))));
f_x_n(92-1)=(M(t,662)-(M(t,56)*M(t,657)));
f_x_n(93-1)=(M(t,632)-(M(t,50)*M(t,627)));
f_x_n(94-1)=(M(t,724)-(M(t,61)*M(t,577)));
f_x_n(95-1)=(M(t,784)-(M(t,65)*M(t,577)));
f_x_n(96-1)=(M(t,457)-(M(t,33)*M(t,479)));
f_x_n(97-1)=(M(t,463)-(M(t,36)*M(t,458)));
f_x_n(98-1)=(((log(M(t,434)))-(log(M(t-1,434))))-(M(t,438)+M(t,439)*((log(M(t,241)))-(log(M(t-1,241))))+M(t,440)*((log(M(t-1,241)))-(log(M(t-1-1,241))))+M(t,441)*((log(M(t,423)))-(log(M(t-1,423))))+M(t,442)*((M(t,477))-(M(t-1,477)))+M(t,437)*((M(t,240))-(M(t-1,240)))+M(t,296)*(log(M(t-1,434))-M(t-1,435)-(log(M(t-1,485))+0.25*(log(M(t-1,423))+log(M(t-2,423))+log(M(t-3,423))+log(M(t-4,423)))+0.012518*M(t-1,240)+0.000565*M(t,808)))+((M(t,435))-(M(t-1,435)))));
f_x_n(99-1)=(M(t,425)-((M(t,500)-M(t,467))/M(t,612)));
return(f_x_n);
}

// [[Rcpp::export]]
mat heart_jacobian_f(arma::mat & M, int & t){
mat Jacobian_n(99,99,arma::fill::zeros);
Jacobian_n.elem( arma::uvec("42 45 143 144 241 243 342 441 442 540 635 765 865 962 1088 1283 1357 1482 1510 1672 1689 1860 1888 2103 2141 2282 2330 2453 2549 2649 2735 2762 2822 2873 2922 3072 3121 3568 3739 3788 3869 4086 4122 4266 4311 4485 4646 4664 4833 4915 5005 5077 5257 5474 5635 5694 5807 5853 5897 6071 6151 6319 6367 6528 6568 6602 6650 6692 6816 6892 6897 6944 6978 6979 6987 7166 7197 7346 7386 7561 7592 7741 7781 7987 8034 8077 8250 8332 8550 8631 8797 8846 9004 9030 9207 9255 9427 9466 9604 9652") ) = arma::vec(100,arma::fill::ones);
Jacobian_n.elem( arma::uvec("542 639 1263 1362 1736 1933 1934 2648 2823 3389 3616 3823 3909 3910 3911 4516 4518 4701 4702 4703 4707 4912 4914 4998 4999 5000 5004 5113 5302 5509 5691 5693 5803 5889 5890 6104 6194 6401 6601 6603 6691 6693 6899 6989 7986 8076 8284 8374 8580 8670 8877 9071") ) = arma::vec(52,arma::fill::ones) - 2;
Jacobian_n(1-1,95-1)=(-M(t,787));
Jacobian_n(2-1,99-1)=(-M(t,792));
Jacobian_n(3-1,31-1)=(-M(t,534));
Jacobian_n(4-1,33-1)=(-M(t,550));
Jacobian_n(5-1,38-1)=(-M(t,590));
Jacobian_n(6-1,25-1)=(-M(t,488));
Jacobian_n(7-1,19-1)=(-M(t,478));
Jacobian_n(8-1,21-1)=(-M(t,483));
Jacobian_n(9-1,41-1)=(-M(t,610));
Jacobian_n(10-1,45-1)=(-M(t,625));
Jacobian_n(11-1,55-1)=(-M(t,655));
Jacobian_n(12-1,49-1)=(-M(t,630));
Jacobian_n(13-1,61-1)=(-M(t,677));
Jacobian_n(14-1,64-1)=(-M(t,717));
Jacobian_n(15-1,72-1)=(-M(t,737));
Jacobian_n(16-1,83-1)=(-M(t,767));
Jacobian_n(17-1,86-1)=(-M(t,772));
Jacobian_n(18-1,69-1)=(-M(t,732));
Jacobian_n(19-1,89-1)=(-M(t,777));
Jacobian_n(20-1,80-1)=(-M(t,762));
Jacobian_n(21-1,76-1)=(-M(t,752));
Jacobian_n(22-1,93-1)=(-(0.01*M(t,791)));
Jacobian_n(22-1,95-1)=(-(0.01*M(t,789)));
Jacobian_n(23-1,97-1)=(-(0.01*M(t,796)));
Jacobian_n(23-1,99-1)=(-(0.01*M(t,794)));
Jacobian_n(24-1,36-1)=(0.01*M(t,594));
Jacobian_n(24-1,38-1)=(0.01*M(t,592));
Jacobian_n(25-1,23-1)=(-(0.01*M(t,492)));
Jacobian_n(25-1,25-1)=(-(0.01*M(t,490)));
Jacobian_n(26-1,17-1)=(-(0.01*M(t,482)));
Jacobian_n(26-1,19-1)=(-(0.01*M(t,480)));
Jacobian_n(27-1,41-1)=(-(0.01*M(t,612)));
Jacobian_n(28-1,43-1)=(-(0.01*M(t,629)));
Jacobian_n(28-1,45-1)=(-(0.01*M(t,627)));
Jacobian_n(29-1,53-1)=(-(0.01*M(t,659)));
Jacobian_n(29-1,55-1)=(-(0.01*M(t,657)));
Jacobian_n(30-1,57-1)=(-(0.01*M(t,664)));
Jacobian_n(31-1,47-1)=(-(0.01*M(t,634)));
Jacobian_n(31-1,49-1)=(-(0.01*M(t,632)));
Jacobian_n(32-1,66-1)=(-(0.01*M(t,726)));
Jacobian_n(33-1,64-1)=(-(0.01*M(t,719)));
Jacobian_n(34-1,86-1)=(-(0.01*M(t,774)));
Jacobian_n(35-1,69-1)=(-(0.01*M(t,734)));
Jacobian_n(36-1,91-1)=(-(0.01*M(t,786)));
Jacobian_n(37-1,89-1)=(-(0.01*M(t,779)));
Jacobian_n(38-1,78-1)=(-(0.01*M(t,766)));
Jacobian_n(38-1,80-1)=(-(0.01*M(t,764)));
Jacobian_n(39-1,74-1)=(-(0.01*M(t,756)));
Jacobian_n(39-1,76-1)=(-(0.01*M(t,754)));
Jacobian_n(40-1,93-1)=(1/M(t,789));
Jacobian_n(40-1,97-1)=(-(1/M(t,794)));
Jacobian_n(41-1,95-1)=(1/M(t,791));
Jacobian_n(41-1,99-1)=(-(1/M(t,796)));
Jacobian_n(42-1,94-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(43-1,40-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(44-1,51-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(45-1,48-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(47-1,60-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(48-1,71-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(71-1,12-1)=(-M(t,473));
Jacobian_n(72-1,21-1)=(-(1/M(t,473)));
Jacobian_n(73-1,14-1)=(-(1/M(t,554)));
Jacobian_n(73-1,15-1)=(-(1/M(t,554)));
Jacobian_n(73-1,33-1)=((M(t,458)+M(t,463)+M(t,466))/pow(M(t,554),2));
Jacobian_n(74-1,33-1)=(M(t,591)/pow(M(t,554),2));
Jacobian_n(74-1,35-1)=(-(1/M(t,554)));
Jacobian_n(77-1,21-1)=(-M(t,43));
Jacobian_n(78-1,95-1)=(-M(t,29));
Jacobian_n(79-1,25-1)=(-M(t,28));
Jacobian_n(80-1,11-1)=(-(M(t,330)/M(t,425)));
Jacobian_n(80-1,41-1)=(1/M(t,614));
Jacobian_n(81-1,21-1)=(-(1.601567/M(t,487)));
Jacobian_n(81-1,55-1)=(1/M(t,659));
Jacobian_n(82-1,45-1)=(-M(t,51));
Jacobian_n(83-1,61-1)=(-M(t,60));
Jacobian_n(84-1,4-1)=(-(0.01*M(t,403)));
Jacobian_n(84-1,31-1)=(-(M(t,401)/M(t,538)));
Jacobian_n(84-1,83-1)=(1/M(t,771));
Jacobian_n(85-1,83-1)=(-M(t,62));
Jacobian_n(86-1,72-1)=(-M(t,64));
Jacobian_n(87-1,8-1)=(-(M(t,314)/M(t,195)));
Jacobian_n(87-1,9-1)=(-(M(t,315)/M(t,198)));
Jacobian_n(87-1,34-1)=(1/M(t,577));
Jacobian_n(88-1,36-1)=(1/M(t,592));
Jacobian_n(88-1,74-1)=(-(M(t,320)/M(t,754)));
Jacobian_n(88-1,78-1)=(-(M(t,319)/M(t,764)));
Jacobian_n(89-1,23-1)=(-M(t,27));
Jacobian_n(90-1,92-1)=(-M(t,38));
Jacobian_n(91-1,34-1)=(-(M(t,341)/M(t,577)));
Jacobian_n(91-1,53-1)=(1/M(t,657));
Jacobian_n(91-1,78-1)=(-(M(t,343)/M(t,764)));
Jacobian_n(92-1,53-1)=(-M(t,56));
Jacobian_n(93-1,43-1)=(-M(t,50));
Jacobian_n(94-1,34-1)=(-M(t,61));
Jacobian_n(95-1,34-1)=(-M(t,65));
Jacobian_n(96-1,16-1)=(-M(t,33));
Jacobian_n(97-1,14-1)=(-M(t,36));
Jacobian_n(98-1,10-1)=(-(M(t,441)/M(t,423)));
Jacobian_n(98-1,12-1)=(1/M(t,434));
Jacobian_n(99-1,26-1)=(-(1/M(t,612)));
return(Jacobian_n);
}

// [[Rcpp::export]]
arma::vec epilogue_equations_f(arma::mat& M, int& t){
arma::vec f_x_n(200);
f_x_n(1-1)=(M(t,800)-(M(t,801)*M(t,797)));
f_x_n(2-1)=(M(t,532)-(M(t,533)*M(t,529)));
f_x_n(3-1)=(M(t,522)-(M(t,523)*M(t,519)));
f_x_n(4-1)=(M(t,527)-(M(t,528)*M(t,524)));
f_x_n(5-1)=(M(t,506)-(M(t,507)*M(t,503)));
f_x_n(6-1)=(M(t,563)-(M(t,564)*M(t,560)));
f_x_n(7-1)=(M(t,548)-(M(t,549)*M(t,545)));
f_x_n(8-1)=(M(t,558)-(M(t,559)*M(t,555)));
f_x_n(9-1)=(M(t,543)-(M(t,544)*M(t,540)));
f_x_n(10-1)=(M(t,583)-(M(t,584)*M(t,580)));
f_x_n(11-1)=(M(t,573)-(M(t,574)*M(t,570)));
f_x_n(12-1)=(M(t,578)-(M(t,579)*M(t,575)));
f_x_n(13-1)=(M(t,598)-(M(t,599)*M(t,595)));
f_x_n(14-1)=(M(t,588)-(M(t,589)*M(t,585)));
f_x_n(15-1)=(M(t,512)-(M(t,513)*M(t,509)));
f_x_n(16-1)=(M(t,623)-(M(t,624)*M(t,620)));
f_x_n(17-1)=(M(t,653)-(M(t,654)*M(t,650)));
f_x_n(18-1)=(M(t,700)-(M(t,701)*M(t,697)));
f_x_n(19-1)=(M(t,705)-(M(t,706)*M(t,702)));
f_x_n(20-1)=(M(t,745)-(M(t,746)*M(t,742)));
f_x_n(21-1)=(M(t,760)-(M(t,761)*M(t,757)));
f_x_n(22-1)=(M(t,798)-(M(t,801)*M(t,799)/100));
f_x_n(23-1)=(M(t,530)-(M(t,533)*M(t,531)/100));
f_x_n(24-1)=(M(t,535)-(M(t,538)*M(t,536)/100));
f_x_n(25-1)=(M(t,520)-(M(t,523)*M(t,521)/100));
f_x_n(26-1)=(M(t,525)-(M(t,528)*M(t,526)/100));
f_x_n(27-1)=(M(t,504)-(M(t,507)*M(t,505)/100));
f_x_n(28-1)=(M(t,561)-(M(t,564)*M(t,562)/100));
f_x_n(29-1)=(M(t,546)-(M(t,549)*M(t,547)/100));
f_x_n(30-1)=(M(t,551)-(M(t,554)*M(t,552)/100));
f_x_n(31-1)=(M(t,556)-(M(t,559)*M(t,557)/100));
f_x_n(32-1)=(M(t,541)-(M(t,544)*M(t,542)/100));
f_x_n(33-1)=(M(t,581)-(M(t,584)*M(t,582)/100));
f_x_n(34-1)=(M(t,571)-(M(t,574)*M(t,572)/100));
f_x_n(35-1)=(M(t,576)-(M(t,579)*M(t,577)/100));
f_x_n(36-1)=(M(t,599)*M(t,597)/100-(M(t,596)));
f_x_n(37-1)=(M(t,589)*M(t,587)/100-(M(t,586)));
f_x_n(38-1)=(M(t,484)-(M(t,487)*M(t,485)/100));
f_x_n(39-1)=(M(t,510)-(M(t,513)*M(t,511)/100));
f_x_n(40-1)=(M(t,621)-(M(t,624)*M(t,622)/100));
f_x_n(41-1)=(M(t,651)-(M(t,654)*M(t,652)/100));
f_x_n(42-1)=(M(t,678)-(M(t,681)*M(t,679)/100));
f_x_n(43-1)=(M(t,698)-(M(t,701)*M(t,699)/100));
f_x_n(44-1)=(M(t,703)-(M(t,706)*M(t,704)/100));
f_x_n(45-1)=(M(t,738)-(M(t,741)*M(t,739)/100));
f_x_n(46-1)=(M(t,743)-(M(t,746)*M(t,744)/100));
f_x_n(47-1)=(M(t,768)-(M(t,771)*M(t,769)/100));
f_x_n(48-1)=(M(t,758)-(M(t,761)*M(t,759)/100));
f_x_n(49-1)=(log(M(t,788))-log(M(t,793))-(M(t,348)));
f_x_n(50-1)=(M(t,112)-(100*(M(t,788)-M(t-1,788))/M(t-1,788)));
f_x_n(51-1)=(M(t,83)-(100*(M(t,530)-M(t-1,530))/M(t-1,788)));
f_x_n(52-1)=(M(t,84)-(100*(M(t,535)-M(t-1,535))/M(t-1,788)));
f_x_n(53-1)=(M(t,89)-(100*(M(t,611)-M(t-1,611))/M(t-1,788)));
f_x_n(54-1)=(M(t,91)-(100*(M(t,626)-M(t-1,626))/M(t-1,788)));
f_x_n(55-1)=(M(t,96)-(100*(M(t,651)-M(t-1,651))/M(t-1,788)));
f_x_n(56-1)=(M(t,92)-(100*(M(t,631)-M(t-1,631))/M(t-1,788)));
f_x_n(57-1)=(M(t,97)-(100*(M(t,656)-M(t-1,656))/M(t-1,788)));
f_x_n(58-1)=(M(t,98)-(100*(M(t,661)-M(t-1,661))/M(t-1,788)));
f_x_n(59-1)=(M(t,99)-(M(t,112)-M(t,107)-M(t,101)-M(t,96)-M(t,92)-M(t,94)-M(t,93)-M(t,95)-M(t,89)-M(t,88)-M(t,90)));
f_x_n(60-1)=(M(t,101)-(100*(M(t,678)-M(t-1,678))/M(t-1,788)));
f_x_n(61-1)=(M(t,105)-(100*(M(t,723)-M(t-1,723))/M(t-1,788)));
f_x_n(62-1)=(M(t,104)-(100*(M(t,718)-M(t-1,718))/M(t-1,788)));
f_x_n(63-1)=(M(t,107)-(-100*(M(t,738)-M(t-1,738))/M(t-1,788)));
f_x_n(64-1)=(M(t,109)-(-100*(M(t,768)-M(t-1,768))/M(t-1,788)));
f_x_n(65-1)=(M(t,111)-(-100*(M(t,783)-M(t-1,783))/M(t-1,788)));
f_x_n(66-1)=(M(t,110)-(-100*(M(t,778)-M(t-1,778))/M(t-1,788)));
f_x_n(67-1)=(M(t,78)-(100*(M(t,489)-M(t-1,489))/M(t-1,788)));
f_x_n(68-1)=(M(t,76)-(100*(M(t,479)-M(t-1,479))/M(t-1,788)));
f_x_n(69-1)=(M(t,77)-(100*(M(t,484)-M(t-1,484))/M(t-1,788)));
f_x_n(70-1)=(M(t,81)-(100*(M(t,510)-M(t-1,510))/M(t-1,788)));
f_x_n(71-1)=(M(t,86)-(100*(M(t,556)-M(t-1,556))/M(t-1,788)));
f_x_n(72-1)=(M(t,85)-(100*(M(t,541)-M(t-1,541))/M(t-1,788)));
f_x_n(73-1)=(M(t,87)-(-100*(M(t,591)-M(t-1,591))/M(t-1,788)));
f_x_n(74-1)=(M(t,80)-(M(t,101)+M(t,107)));
f_x_n(75-1)=(M(t,157)-((M(t,813))*(100*(M(t,532)/M(t,787)-(M(t-1,532)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,529)/M(t,787)-(M(t-1,529)/M(t-1,787)))*(M(t-1,533)+M(t-2,533)+M(t-3,533)+M(t-4,533))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,532)/M(t,787)-(M(t-1,532)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(76-1)=(M(t,158)-((M(t,813))*(100*(M(t,537)/M(t,787)-(M(t-1,537)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,534)/M(t,787)-(M(t-1,534)/M(t-1,787)))*(M(t-1,538)+M(t-2,538)+M(t-3,538)+M(t-4,538))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,537)/M(t,787)-(M(t-1,537)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(77-1)=(M(t,165)-((M(t,813))*(100*(M(t,628)/M(t,787)-(M(t-1,628)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,625)/M(t,787)-(M(t-1,625)/M(t-1,787)))*(M(t-1,629)+M(t-2,629)+M(t-3,629)+M(t-4,629))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,628)/M(t,787)-(M(t-1,628)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(78-1)=(M(t,171)-((M(t,813))*(100*(M(t,658)/M(t,787)-(M(t-1,658)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,655)/M(t,787)-(M(t-1,655)/M(t-1,787)))*(M(t-1,659)+M(t-2,659)+M(t-3,659)+M(t-4,659))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,658)/M(t,787)-(M(t-1,658)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(79-1)=(M(t,178)-((M(t,813))*(100*(M(t,720)/M(t,787)-(M(t-1,720)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,717)/M(t,787)-(M(t-1,717)/M(t-1,787)))*(M(t-1,721)+M(t-2,721)+M(t-3,721)+M(t-4,721))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,720)/M(t,787)-(M(t-1,720)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(80-1)=(-M(t,183)-((M(t,813))*(100*(M(t,770)/M(t,787)-(M(t-1,770)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,767)/M(t,787)-(M(t-1,767)/M(t-1,787)))*(M(t-1,771)+M(t-2,771)+M(t-3,771)+M(t-4,771))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,770)/M(t,787)-(M(t-1,770)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(81-1)=(-M(t,184)-((M(t,813))*(100*(M(t,780)/M(t,787)-(M(t-1,780)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,777)/M(t,787)-(M(t-1,777)/M(t-1,787)))*(M(t-1,781)+M(t-2,781)+M(t-3,781)+M(t-4,781))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,780)/M(t,787)-(M(t-1,780)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(82-1)=(M(t,152)-((M(t,813))*(100*(M(t,491)/M(t,787)-(M(t-1,491)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,488)/M(t,787)-(M(t-1,488)/M(t-1,787)))*(M(t-1,492)+M(t-2,492)+M(t-3,492)+M(t-4,492))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,491)/M(t,787)-(M(t-1,491)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(83-1)=(M(t,150)-((M(t,813))*(100*(M(t,481)/M(t,787)-(M(t-1,481)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,478)/M(t,787)-(M(t-1,478)/M(t-1,787)))*(M(t-1,482)+M(t-2,482)+M(t-3,482)+M(t-4,482))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,481)/M(t,787)-(M(t-1,481)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(84-1)=(M(t,151)-((M(t,813))*(100*(M(t,486)/M(t,787)-(M(t-1,486)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,483)/M(t,787)-(M(t-1,483)/M(t-1,787)))*(M(t-1,487)+M(t-2,487)+M(t-3,487)+M(t-4,487))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,486)/M(t,787)-(M(t-1,486)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(85-1)=(M(t,155)-((M(t,813))*(100*(M(t,512)/M(t,787)-(M(t-1,512)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,509)/M(t,787)-(M(t-1,509)/M(t-1,787)))*(M(t-1,513)+M(t-2,513)+M(t-3,513)+M(t-4,513))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,512)/M(t,787)-(M(t-1,512)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(86-1)=(M(t,160)-((M(t,813))*(100*(M(t,558)/M(t,787)-(M(t-1,558)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,555)/M(t,787)-(M(t-1,555)/M(t-1,787)))*(M(t-1,559)+M(t-2,559)+M(t-3,559)+M(t-4,559))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,558)/M(t,787)-(M(t-1,558)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(87-1)=(M(t,159)-((M(t,813))*(100*(M(t,543)/M(t,787)-(M(t-1,543)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,540)/M(t,787)-(M(t-1,540)/M(t-1,787)))*(M(t-1,544)+M(t-2,544)+M(t-3,544)+M(t-4,544))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,543)/M(t,787)-(M(t-1,543)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(88-1)=(-M(t,161)-((M(t,813))*(100*(M(t,593)/M(t,787)-(M(t-1,593)/M(t-1,787)))*1/M(t-1,791)-100*(M(t,590)/M(t,787)-(M(t-1,590)/M(t-1,787)))*(M(t-1,594)+M(t-2,594)+M(t-3,594)+M(t-4,594))/(M(t-1,791)+M(t-2,791)+M(t-3,791)+M(t-4,791)))+(1-M(t,813))*(100*(M(t,593)/M(t,787)-(M(t-1,593)/M(t-1,787)))*1/M(t-1,791))));
f_x_n(89-1)=(M(t,154)-(M(t,175)+M(t,181)));
f_x_n(90-1)=(M(t,149)-(M(t,112)-M(t,186)));
f_x_n(91-1)=(M(t,120)-(M(t,83)-M(t,157)));
f_x_n(92-1)=(M(t,121)-(M(t,84)-M(t,158)));
f_x_n(93-1)=(M(t,126)-(M(t,89)-M(t,163)));
f_x_n(94-1)=(M(t,128)-(M(t,91)-M(t,165)));
f_x_n(95-1)=(M(t,133)-(M(t,96)-M(t,170)));
f_x_n(96-1)=(M(t,134)-(M(t,97)-M(t,171)));
f_x_n(97-1)=(M(t,135)-(M(t,98)-M(t,172)));
f_x_n(98-1)=(M(t,129)-(M(t,92)-M(t,166)));
f_x_n(99-1)=(M(t,136)-(M(t,149)-M(t,144)-M(t,138)-M(t,133)-M(t,129)-M(t,131)-M(t,130)-M(t,132)-M(t,126)-M(t,125)-M(t,127)));
f_x_n(100-1)=(M(t,138)-(M(t,101)-M(t,175)));
f_x_n(101-1)=(M(t,142)-(M(t,105)-M(t,179)));
f_x_n(102-1)=(M(t,141)-(M(t,104)-M(t,178)));
f_x_n(103-1)=(M(t,144)-(M(t,107)-M(t,181)));
f_x_n(104-1)=(M(t,146)-(M(t,109)-M(t,183)));
f_x_n(105-1)=(M(t,148)-(M(t,111)-M(t,185)));
f_x_n(106-1)=(M(t,147)-(M(t,110)-M(t,184)));
f_x_n(107-1)=(M(t,115)-(M(t,78)-M(t,152)));
f_x_n(108-1)=(M(t,113)-(M(t,76)-M(t,150)));
f_x_n(109-1)=(M(t,114)-(M(t,77)-M(t,151)));
f_x_n(110-1)=(M(t,118)-(M(t,81)-M(t,155)));
f_x_n(111-1)=(M(t,123)-(M(t,86)-M(t,160)));
f_x_n(112-1)=(M(t,122)-(M(t,85)-M(t,159)));
f_x_n(113-1)=(M(t,124)-(M(t,87)-M(t,161)));
f_x_n(114-1)=(M(t,117)-(M(t,138)+M(t,144)));
f_x_n(115-1)=(M(t,522)-(0.253*M(t,613)+0.096*M(t,608)+0.365*M(t,658)+0.187*M(t,663)+0.178*M(t,643)+0.251*M(t,638)+0.21*M(t,680)));
f_x_n(116-1)=(M(t,527)-(M(t,800)-M(t,666)));
f_x_n(117-1)=(M(t,800)-(M(t,790)+M(t,740)));
f_x_n(118-1)=(M(t,506)-(M(t,680)-M(t,740)));
f_x_n(119-1)=(M(t,563)-(M(t,491)+M(t,598)));
f_x_n(120-1)=(M(t,548)-(M(t,481)+M(t,588)));
f_x_n(121-1)=(M(t,558)-(M(t,553)-M(t,543)));
f_x_n(122-1)=(M(t,583)-(M(t,563)-M(t,680)));
f_x_n(123-1)=(M(t,573)+M(t,680)-M(t,670)-(M(t,553)));
f_x_n(124-1)=(M(t,578)+M(t,680)-M(t,670)-(M(t,553)-M(t,543)));
f_x_n(125-1)=(M(t,598)-(M(t,588)+M(t,593)+M(t,603)));
f_x_n(126-1)=(M(t,491)-(M(t,790)-M(t,512)));
f_x_n(127-1)=(M(t,623)-(M(t,628)+M(t,666)));
f_x_n(128-1)=(M(t,700)-(M(t,680)-M(t,690)));
f_x_n(129-1)=(M(t,705)-(M(t,680)-M(t,690)-M(t,675)));
f_x_n(130-1)=(M(t,745)-(M(t,730)+M(t,770)+M(t,750)));
f_x_n(131-1)=(M(t,760)-(M(t,740)-M(t,750)));
f_x_n(132-1)=(M(t,788)-(M(t,606)+M(t,611)+M(t,616)+M(t,651)+M(t,631)+M(t,636)+M(t,641)+M(t,646)+M(t,665)+M(t,678)-M(t,738)));
f_x_n(133-1)=(M(t,530)-(M(t,606)+M(t,611)+M(t,616)+M(t,651)+M(t,631)+M(t,636)+M(t,641)+M(t,646)+M(t,665)));
f_x_n(134-1)=(M(t,535)-(M(t,530)-M(t,665)));
f_x_n(135-1)=(M(t,520)-(0.253*M(t,611)+0.096*M(t,606)+0.365*M(t,656)+0.187*M(t,661)+0.178*M(t,641)+0.251*M(t,636)+0.21*M(t,678)));
f_x_n(136-1)=(M(t,525)-(M(t,798)-M(t,665)));
f_x_n(137-1)=(M(t,798)-(M(t,788)+M(t,738)));
f_x_n(138-1)=(M(t,504)-(M(t,678)-M(t,738)));
f_x_n(139-1)=(M(t,561)-(M(t,489)+M(t,596)));
f_x_n(140-1)=(M(t,546)-(M(t,479)+M(t,586)));
f_x_n(141-1)=(M(t,556)-(M(t,551)-M(t,541)));
f_x_n(142-1)=(M(t,581)-(M(t,561)-M(t,678)));
f_x_n(143-1)=(M(t,571)+M(t,678)-M(t,668)-(M(t,551)));
f_x_n(144-1)=(M(t,576)+M(t,678)-M(t,668)-(M(t,551)-M(t,541)));
f_x_n(145-1)=(M(t,596)-(M(t,586)+M(t,591)+M(t,601)));
f_x_n(146-1)=(M(t,551)-(M(t,484)+M(t,591)));
f_x_n(147-1)=(M(t,489)-(M(t,479)+M(t,484)+M(t,494)));
f_x_n(148-1)=(M(t,621)-(M(t,626)+M(t,665)));
f_x_n(149-1)=(M(t,698)-(M(t,678)-M(t,688)));
f_x_n(150-1)=(M(t,703)-(M(t,678)-M(t,688)-M(t,673)));
f_x_n(151-1)=(M(t,743)-(M(t,728)+M(t,768)+M(t,748)));
f_x_n(152-1)=(M(t,758)-(M(t,738)-M(t,748)));
f_x_n(153-1)=(M(t,453)-(M(t,457)+M(t,462)));
f_x_n(154-1)=(M(t,454)-(M(t,458)+M(t,463)));
f_x_n(155-1)=(M(t,455)-(M(t,453)+M(t,454)+M(t,456)));
f_x_n(156-1)=(M(t,459)-(M(t,457)+M(t,458)+M(t,461)));
f_x_n(157-1)=(M(t,464)-(M(t,462)+M(t,463)+M(t,465)));
f_x_n(158-1)=(M(t,825)-(M(t,434)/M(t,428)));
f_x_n(159-1)=(M(t,436)-(M(t,434)/M(t,241)));
f_x_n(160-1)=(M(t,424)-(M(t,487)/M(t,474)));
f_x_n(161-1)=(M(t,193)-((M(t,455)+M(t,26))/M(t,791)));
f_x_n(162-1)=(M(t,194)-((M(t,455)+M(t,26))/M(t,492)));
f_x_n(163-1)=(M(t,196)-((M(t,195)+M(t-1,195)+M(t-2,195)+M(t-3,195))/4));
f_x_n(164-1)=(M(t,192)-((M(t,458)+M(t,463))/M(t,487)));
f_x_n(165-1)=(M(t,498)-(M(t,484)-M(t,458)-M(t,463)-M(t,466)));
f_x_n(166-1)=(M(t,450)-(100*M(t,498)/M(t,484)));
f_x_n(167-1)=(M(t,499)-(M(t,500)/M(t,612)));
f_x_n(168-1)=(M(t,449)-(100*(1-M(t,611)/M(t,500))));
f_x_n(169-1)=(M(t,74)-(M(t,759)/M(t,577)));
f_x_n(170-1)=(M(t,75)-(M(t,784)/M(t,577)));
f_x_n(171-1)=(M(t,71)-(M(t,416)/M(t,679)));
f_x_n(172-1)=(M(t,72)-(M(t,197)/M(t,193)));
f_x_n(173-1)=(M(t,73)-(M(t,197)/M(t,194)*M(t,471)/M(t,475)));
f_x_n(174-1)=(M(t,8)-((M(t,678)-M(t,738))/1000));
f_x_n(175-1)=(M(t,9)-((M(t,683)-M(t,743))/1000));
f_x_n(176-1)=(M(t,12)-((M(t,708)-M(t,768))/1000));
f_x_n(177-1)=(M(t,13)-((M(t,713)-M(t,773))/1000));
f_x_n(178-1)=(M(t,15)-((M(t,723)-M(t,783))/1000));
f_x_n(179-1)=(M(t,7)-((M(t,673)-M(t,733))/1000));
f_x_n(180-1)=(M(t,11)-((M(t,693)-M(t,753))/1000));
f_x_n(181-1)=(M(t,14)-((M(t,718)-M(t,778))/1000));
f_x_n(182-1)=(M(t,190)-(M(t,657)/M(t,485)*(M(t,818)-100*(M(t,657)/M(t-4,657)-1)+9)));
f_x_n(183-1)=(M(t,544)-(M(t,41)*M(t,492)));
f_x_n(184-1)=(M(t,589)-(M(t,42)*M(t,492)));
f_x_n(185-1)=(M(t,337)-(M(t,662)/M(t,417)));
f_x_n(186-1)=(M(t,426)-(M(t,500)/M(t,642)));
f_x_n(187-1)=(M(t,380)-(100*M(t,749)/M(t,557)));
f_x_n(188-1)=(M(t,191)-(M(t,195)+M(t,198)));
f_x_n(189-1)=(M(t,592)-(M(t,44)*M(t,597)));
f_x_n(190-1)=(M(t,637)-(M(t,52)*M(t,577)));
f_x_n(191-1)=(((log(M(t,769)))-(log(M(t-1,769))))-(M(t,398)+M(t,399)*((log(M(t,415)))-(log(M(t-1,415))))+M(t,397)*(((log(M(t-1,769)))-(log(M(t-1-1,769))))-((M(t-1,382))-(M(t-1-1,382))))+M(t,286)*(log(M(t-1,769))-M(t-1,382)-(0.379918+(1-0.381817)*log(M(t-1,415))+0.381817*log(M(t-1,577))-0.003963*M(t-1,802)))+((M(t,382))-(M(t-1,382)))));
f_x_n(192-1)=(M(t,462)-(M(t,35)*M(t,457)));
f_x_n(193-1)=(((log(M(t,219)*M(t,474)/M(t,473)-M(t,413)))-(log(M(t-1,219)*M(t-1,474)/M(t-1,473)-M(t-1,413))))-(M(t,218)+M(t,217)*((log(M(t,487)))-(log(M(t-1,487))))+M(t,215)*(((log(M(t-1,219)*M(t-1,474)/M(t-1,473)-M(t-1,413)))-(log(M(t-1-1,219)*M(t-1-1,474)/M(t-1-1,473)-M(t-1-1,413))))-((M(t-1,220))-(M(t-1-1,220))))+M(t,216)*(((log(M(t-2,219)*M(t-2,474)/M(t-2,473)-M(t-2,413)))-(log(M(t-1-2,219)*M(t-1-2,474)/M(t-1-2,473)-M(t-1-2,413))))-((M(t-2,220))-(M(t-1-2,220))))+M(t,273)*(log(M(t-1,219)*M(t-1,474)/M(t-1,473)-M(t-1,413))-M(t-1,220)-(log(M(t-1,487))-0.0007545/0.1155*M(t-1,802)+0.0002383/0.1155*M(t-1,807)+0.0001069/0.1155*M(t-1,809)+0.001793/0.1155*M(t-1,427)+0.0005*M(t-1,810)))+((M(t,220))-(M(t-1,220)))));
f_x_n(194-1)=(((log(M(t,825)))-(log(M(t-1,825))))-(M(t,827)+M(t,828)*((log(M(t,487)))-(log(M(t-1,487))))+M(t,297)*M(t,236)+M(t,298)*M(t,237)+M(t,299)*M(t,238)+((M(t,826))-(M(t-1,826)))));
f_x_n(195-1)=(M(t,451)-(M(t,32)*M(t,788)));
f_x_n(196-1)=(M(t,508)-(M(t,34)*M(t,458)));
f_x_n(197-1)=(M(t,469)-(M(t,39)*M(t,458)));
f_x_n(198-1)=(((log(M(t,470)))-(log(M(t-1,470))))-((M(t,812)-1)*(M(t,812)-3)*(M(t,812)-4)/2*17.4/100*((1/3*M(t-1,241)+M(t-2,241)+M(t-3,241)+M(t-4,241)+2/3*M(t-5,241))/(1/3*M(t-5,241)+M(t-6,241)+M(t-7,241)+M(t-8,241)+2/3*M(t-9,241))-1)+(M(t,812)-1)*(M(t,812)-2)*(M(t,812)-3)/6*64.7/100*((1/3*M(t-1,241)+M(t-2,241)+M(t-3,241)+M(t-4,241)+2/3*M(t-5,241))/(1/3*M(t-5,241)+M(t-6,241)+M(t-7,241)+M(t-8,241)+2/3*M(t-9,241))-1)+7.2/100*(0.5*((log(M(t,241)))-(log(M(t-1,241))))-4*((log(M(t,473)))-(log(M(t-1,473))))+0.5*((log(M(t,434)))-(log(M(t-1,434))))))-(((M(t,203))-(M(t-1,203)))+M(t,205)+M(t,270)*(log(M(t-1,470))-M(t-1,203))+M(t,271)*M(t-1,802)));
f_x_n(199-1)=(M(t,814)-(M(t,68)*M(t,487)/M(t,539)));
f_x_n(200-1)=(M(t,654)/1000-(M(t,539)-M(t-1,539)*(1-M(t,69)/100)));
return(f_x_n);
}

// [[Rcpp::export]]
mat epilogue_jacobian_f(arma::mat & M, int & t){
mat Jacobian_n(200,200,arma::fill::zeros);
Jacobian_n.elem( arma::uvec("178 373 574 779 975 1176 1380 1577 2570 2771 2972 3168 3369 3467 3668 3866 4073 4269 4450 4651 4871 5070 5272 5452 5458 5653 5855 5858 6054 6058 6256 6457 6658 6858 6859 7061 7260 7458 7462 7663 7865 8064 8249 8507 8708 8906 9113 9309 9490 9691 9911 10110 10312 10492 10498 10693 10897 10898 11094 11098 11295 11496 11698 11898 11899 12101 12300 12498 12502 12703 12905 13104 13289 13482 13507 13683 13708 13881 13906 14088 14284 14309 14474 14490 14675 14691 14886 14911 15085 15110 15312 15476 15493 15677 15695 15878 15901 16103 16305 16581 16787 16963 17160 17361 17562 18184 18586 18959 19185 19358 19567 19765 19952 20153 20354 20555 20791 20956 21037 21564 21766 21826 21937 22204 22317 22814 22925 23224 23334 23602 23714 24025 24135 24403 24515 24822 24932 25423 25533 26031 26140 26143 26408 26520 26523 26782 26828 26939 27206 27319 27629 27745 28030 28140 28407 28520 28827 28938 29205 29318 29633 29742 30010 30122 30434 30543 30611 30723 31032 31141 31409 31521 32213 32583 32744 33012 33124 33439 33547 33815 33926 34733 34735 35042 35148 35417 35527 35843 35949 36218 36328 36845 36950 37219 37329 37647 37751 38020 38130 38621 38736 39000 39116 39598 39757") ) = arma::vec(205,arma::fill::ones);
Jacobian_n.elem( arma::uvec("3507 3708 3906 4309 4490 4691 4911 5110 5312 5492 5693 5897 6094 6295 6496 6873 6899 7101 7300 7473 7502 7703 7905 8104 8258 8289 11913 12513 13298 15287 16079 16280 17797 17992 18248 18790 19954 20154 20752 20756 21145 21146 21164 24933 25999 27740 27742 27743 28941 29321 31836 31939 31944 32319 32324 32635 32738 33118 34731 34732 34747 38735 39115 39993") ) = arma::vec(64,arma::fill::ones) - 2;
Jacobian_n(1-1,197-1)=(-M(t,797));
Jacobian_n(2-1,127-1)=(-M(t,529));
Jacobian_n(3-1,120-1)=(-M(t,519));
Jacobian_n(4-1,124-1)=(-M(t,524));
Jacobian_n(5-1,113-1)=(-M(t,503));
Jacobian_n(6-1,148-1)=(-M(t,560));
Jacobian_n(7-1,138-1)=(-M(t,545));
Jacobian_n(8-1,144-1)=(-M(t,555));
Jacobian_n(9-1,134-1)=(-M(t,540));
Jacobian_n(10-1,159-1)=(-M(t,580));
Jacobian_n(11-1,152-1)=(-M(t,570));
Jacobian_n(12-1,155-1)=(-M(t,575));
Jacobian_n(13-1,167-1)=(-M(t,595));
Jacobian_n(14-1,163-1)=(-M(t,585));
Jacobian_n(15-1,116-1)=(-M(t,509));
Jacobian_n(16-1,171-1)=(-M(t,620));
Jacobian_n(17-1,173-1)=(-M(t,650));
Jacobian_n(18-1,179-1)=(-M(t,697));
Jacobian_n(19-1,183-1)=(-M(t,702));
Jacobian_n(20-1,188-1)=(-M(t,742));
Jacobian_n(21-1,192-1)=(-M(t,757));
Jacobian_n(22-1,195-1)=(-(0.01*M(t,801)));
Jacobian_n(22-1,197-1)=(-(0.01*M(t,799)));
Jacobian_n(23-1,126-1)=(-(0.01*M(t,533)));
Jacobian_n(23-1,127-1)=(-(0.01*M(t,531)));
Jacobian_n(24-1,129-1)=(-(0.01*M(t,538)));
Jacobian_n(25-1,118-1)=(-(0.01*M(t,523)));
Jacobian_n(25-1,120-1)=(-(0.01*M(t,521)));
Jacobian_n(26-1,122-1)=(-(0.01*M(t,528)));
Jacobian_n(26-1,124-1)=(-(0.01*M(t,526)));
Jacobian_n(27-1,111-1)=(-(0.01*M(t,507)));
Jacobian_n(27-1,113-1)=(-(0.01*M(t,505)));
Jacobian_n(28-1,146-1)=(-(0.01*M(t,564)));
Jacobian_n(28-1,148-1)=(-(0.01*M(t,562)));
Jacobian_n(29-1,136-1)=(-(0.01*M(t,549)));
Jacobian_n(29-1,138-1)=(-(0.01*M(t,547)));
Jacobian_n(30-1,140-1)=(-(0.01*M(t,554)));
Jacobian_n(31-1,142-1)=(-(0.01*M(t,559)));
Jacobian_n(31-1,144-1)=(-(0.01*M(t,557)));
Jacobian_n(32-1,132-1)=(-(0.01*M(t,544)));
Jacobian_n(32-1,134-1)=(-(0.01*M(t,542)));
Jacobian_n(33-1,157-1)=(-(0.01*M(t,584)));
Jacobian_n(33-1,159-1)=(-(0.01*M(t,582)));
Jacobian_n(34-1,150-1)=(-(0.01*M(t,574)));
Jacobian_n(34-1,152-1)=(-(0.01*M(t,572)));
Jacobian_n(35-1,155-1)=(-(0.01*M(t,577)));
Jacobian_n(36-1,165-1)=(0.01*M(t,599));
Jacobian_n(36-1,167-1)=(0.01*M(t,597));
Jacobian_n(37-1,161-1)=(0.01*M(t,589));
Jacobian_n(37-1,163-1)=(0.01*M(t,587));
Jacobian_n(38-1,107-1)=(-(0.01*M(t,487)));
Jacobian_n(39-1,114-1)=(-(0.01*M(t,513)));
Jacobian_n(39-1,116-1)=(-(0.01*M(t,511)));
Jacobian_n(40-1,169-1)=(-(0.01*M(t,624)));
Jacobian_n(40-1,171-1)=(-(0.01*M(t,622)));
Jacobian_n(41-1,172-1)=(-(0.01*M(t,654)));
Jacobian_n(41-1,173-1)=(-(0.01*M(t,652)));
Jacobian_n(42-1,175-1)=(-(0.01*M(t,681)));
Jacobian_n(43-1,177-1)=(-(0.01*M(t,701)));
Jacobian_n(43-1,179-1)=(-(0.01*M(t,699)));
Jacobian_n(44-1,181-1)=(-(0.01*M(t,706)));
Jacobian_n(44-1,183-1)=(-(0.01*M(t,704)));
Jacobian_n(45-1,184-1)=(-(0.01*M(t,741)));
Jacobian_n(46-1,186-1)=(-(0.01*M(t,746)));
Jacobian_n(46-1,188-1)=(-(0.01*M(t,744)));
Jacobian_n(47-1,193-1)=(-(0.01*M(t,771)));
Jacobian_n(48-1,190-1)=(-(0.01*M(t,761)));
Jacobian_n(48-1,192-1)=(-(0.01*M(t,759)));
Jacobian_n(51-1,125-1)=(-(100/M(t-1,788)));
Jacobian_n(52-1,128-1)=(-(100/M(t-1,788)));
Jacobian_n(69-1,106-1)=(-(100/M(t-1,788)));
Jacobian_n(71-1,141-1)=(-(100/M(t-1,788)));
Jacobian_n(72-1,131-1)=(-(100/M(t-1,788)));
Jacobian_n(85-1,115-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(86-1,143-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(87-1,133-1)=(-((100*(1-M(t,813))+100*M(t,813))/(M(t-1,791)*M(t,787))));
Jacobian_n(161-1,102-1)=(-(1/M(t,791)));
Jacobian_n(162-1,102-1)=(-(1/M(t,492)));
Jacobian_n(166-1,106-1)=(100*(M(t,498)/pow(M(t,484),2)));
Jacobian_n(166-1,108-1)=(-(100/M(t,484)));
Jacobian_n(169-1,190-1)=(-(1/M(t,577)));
Jacobian_n(171-1,175-1)=(M(t,416)/pow(M(t,679),2));
Jacobian_n(172-1,86-1)=(M(t,197)/pow(M(t,193),2));
Jacobian_n(173-1,87-1)=(M(t,197)*M(t,471)/(pow(M(t,194),2)*M(t,475)));
Jacobian_n(175-1,185-1)=0.001;
Jacobian_n(182-1,107-1)=(M(t,657)*(9+M(t,818)-100*(M(t,657)/M(t-4,657)-1))/pow(M(t,485),2));
Jacobian_n(187-1,142-1)=(100*(M(t,749)/pow(M(t,557),2)));
Jacobian_n(189-1,165-1)=(-M(t,44));
Jacobian_n(190-1,12-1)=(-M(t,577));
Jacobian_n(191-1,193-1)=(1/M(t,769));
Jacobian_n(194-1,199-1)=(1/M(t,825));
Jacobian_n(195-1,9-1)=(-M(t,788));
Jacobian_n(196-1,10-1)=(-M(t,458));
Jacobian_n(197-1,11-1)=(-M(t,458));
Jacobian_n(199-1,130-1)=(M(t,68)*M(t,487)/pow(M(t,539),2));
Jacobian_n(200-1,173-1)=0.001;
return(Jacobian_n);
}

// [[Rcpp::export]]
arma::mat Rcpp_solver(arma::mat& M,
                            int& first_date, int& last_date,
                            double& convergenceCriteria,
                            arma::uvec& endo, arma::uvec& prologue_endo, arma::uvec& heart_endo, arma::uvec& epilogue_endo,
                            bool& has_prologue, bool& has_heart, bool& has_epilogue, StringVector& time_line){


  // Delaration des variables
  arma::uvec tt;
  mat Jacobian_n;
  arma::mat f_x_n;
  arma::vec x_n;
  arma::sp_mat sp_jac;
  arma::vec x_n1;
  int t;
  int n;
  double convergence;
  bool s;

  // A chaque periode on fait un newton pour chaque sous partie du modele
  for (t = first_date; t<=last_date ; t++) {


    // Initialisation a chaque periode
    tt = t;
    M.submat(tt,endo) = M.submat(tt-1, endo);


//Prologue
    if(has_prologue){
      n = 0;
      convergence=convergenceCriteria;
      s = false;
      x_n = M.submat(tt,prologue_endo).t();
      x_n1 = arma::vec(x_n.size(), arma::fill::ones);
      while (s == false){
        if (n>0) {
          x_n = x_n1;
          M.submat(tt, prologue_endo) = x_n1.t();
          if(n>10){convergence=10*convergenceCriteria;n=1;}
        }
        Jacobian_n = prologue_jacobian_f(M, t);
        f_x_n = prologue_equations_f(M,t);
        sp_jac = sp_mat(Jacobian_n);
        x_n1 = x_n - spsolve(sp_jac, f_x_n);
        s = arma::approx_equal(x_n1,x_n, "absdiff", convergence);
        n++;
      }
      M.submat(tt, prologue_endo) = x_n1.t();
    }



//Heart
    if(has_heart){
      n = 0;
      convergence=convergenceCriteria;
      s = false;
      x_n = M.submat(tt,heart_endo).t();
      x_n1 = arma::vec(x_n.size(), arma::fill::ones);

      while (s == false){
        if (n>0) {
          x_n = x_n1;
          M.submat(tt, heart_endo) = x_n1.t();
          if(n>10){convergence=10*convergenceCriteria;n=1;}
        }
        Jacobian_n = heart_jacobian_f(M,t);
        f_x_n = heart_equations_f(M,t);
        sp_jac = sp_mat(Jacobian_n);
        x_n1 = x_n - spsolve(sp_jac, f_x_n);
        s = arma::approx_equal(x_n1,x_n, "absdiff", convergence);
        n++;
      }
      M.submat(tt, heart_endo) = x_n1.t();
    }


//Epilogue
    if(has_epilogue){
      n = 0;
      convergence=convergenceCriteria;
      s = false;
      x_n = M.submat(tt,epilogue_endo).t();
      x_n1 = arma::vec(x_n.size(), arma::fill::ones);

      while (s == false){
        if (n>0) {
          x_n = x_n1;
          M.submat(tt, epilogue_endo) = x_n1.t();
          if(n>10){convergence=10*convergenceCriteria;n=1;}
        }
        Jacobian_n = epilogue_jacobian_f(M,t);
        f_x_n = epilogue_equations_f(M,t);
        sp_jac = sp_mat(Jacobian_n);
        x_n1 = x_n - spsolve(sp_jac, f_x_n);
        s = arma::approx_equal(x_n1,x_n, "absdiff", convergence);
        n++;
      }
      M.submat(tt, epilogue_endo) = x_n1.t();
    }


 Rcout << "  " ;
 Rcout << time_line(t) ;
 Rcout << " ... \n" ;
 }
return M;
}

